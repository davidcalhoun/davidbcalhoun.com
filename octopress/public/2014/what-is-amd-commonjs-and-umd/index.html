<!doctype html>
<html lang="en-US">
<head>
	<meta charset="utf-8">
	<title>What is AMD, CommonJS, and UMD?  | David Calhoun</title>

	<meta name="author" content="David Calhoun">

<meta name="description" content="What Is AMD, CommonJS, and UMD? Apr 30th, 2014 11:59 am Intro
Over the years there’s been a steadily increasing ecosystem of JavaScript components &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="David Calhoun" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="/javascripts/html5.js"></script><![endif]-->
	

</head>



<body>
	<header id="header" class="inner" role="banner" aria-labelledby="header_title"><h1><a href="/" id="header_title">David Calhoun</a></h1>
<span class="tagline"></span>

</header>
	<div id="content" class="inner" role="main"><article class="post" role="main" itemscope itemType="http://schema.org/BlogPosting">
	<meta itemprop="inLanguage" content="en-US" />
	<span itemscope itemprop="author" itemType="https://schema.org/Person">
		<meta itemprop="name" content="David Calhoun" />
	</span>
	<span itemscope itemprop="publisher" itemType="https://schema.org/Organization">
		<meta itemprop="name" content="David Calhoun" />
		<meta itemprop="url" content="http://themaingate.net" />
		<meta itemprop="logo" content="http://themaingate.net/david-calhoun-logo.png">
	</span>
	<meta itemprop="image" content="http://themaingate.net/david-calhoun-logo.png">
	<header>
		<h2 class="title" itemprop="headline"><a itemprop="url" href="">What Is AMD, CommonJS, and UMD?</a></h2>
		



<span class="meta date" itemprop="datePublished dateModified" content="2014-04-30 11:59:21 -0700" datetime="2014-04-30 11:59:21 -0700"><time class='entry-date' datetime='2014-04-30T11:59:21-07:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:59 am</span></time></span>
	</header>
	<div class="entry-content" itemprop="articleBody"><h2 id="intro">Intro</h2>
<p>Over the years there’s been a steadily increasing ecosystem of JavaScript components to choose from.  The sheer amount of choices is fantastic, but this also infamously presents a difficulty when components are mixed-and-matched.  And it doesn’t take too long for budding developers to find out that not all components are built to play nicely together.</p>

<p>To address these issues, the competing module specs AMD and CommonJS have appeared on the scene, allowing developers to write their code in an agreed-upon sandboxed and modularized way, so as not to “pollute the ecosystem”.</p>

<h2 id="amd">AMD</h2>
<p>Asynchronous Module Definition (AMD) has gained traction on the frontend, with RequireJS being the most popular implementation.</p>

<p>Here’s module <code>foo</code> with a single dependency on <code>jquery</code>:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="c1">//    filename: foo.js</span>
</span><span class="line"><span class="nx">define</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">//    methods</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">myFunc</span><span class="p">(){};</span>
</span><span class="line">
</span><span class="line">    <span class="c1">//    exposed public methods</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">myFunc</span><span class="p">;</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And a little more complicated example with multiple dependencies and multiple exposed methods:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="c1">//    filename: foo.js</span>
</span><span class="line"><span class="nx">define</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">,</span> <span class="s1">&#39;underscore&#39;</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">//    methods</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">a</span><span class="p">(){};</span>    <span class="c1">//    private because it&#39;s not returned (see below)</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">b</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s returned</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">c</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s returned</span>
</span><span class="line">
</span><span class="line">    <span class="c1">//    exposed public methods</span>
</span><span class="line">    <span class="k">return</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span>
</span><span class="line">        <span class="nx">c</span><span class="o">:</span> <span class="nx">c</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The first part of the define is an array of dependencies, while the second part is essentially the callback function which is only executed when the dependencies are available (script loaders like RequireJS take care of that part, including figuring out where the files are located).</p>

<p>Note that the dependency to variable order is important (ex. jquery-&gt;<code>$</code>, underscore-&gt;<code>_</code>).</p>

<p>Also note that we can map the dependencies to any arbitrary variables we want here.  If we change <code>$</code> to <code>$$</code> in the code above, all jQuery references within our function block will be <code>$$</code> instead of <code>$</code>.</p>

<p>And note, most importantly, that you can’t reference the variables <code>$</code> and <code>_</code> outside of the function, because it’s sandboxed from other code.  That’s the goal here!</p>

<h2 id="commonjs">CommonJS</h2>

<p>CommonJS is a style you may be familiar with if you’re written anything in Node (which uses a slight variant).  It’s also been gaining traction on the frontend with Browserify.</p>

<p>Using the same format as before, here’s what our <code>foo</code> module looks like in CommonJS:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="c1">//    filename: foo.js</span>
</span><span class="line">
</span><span class="line"><span class="c1">//    dependencies</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery&#39;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="c1">//    methods</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">myFunc</span><span class="p">(){};</span>
</span><span class="line">
</span><span class="line"><span class="c1">//    exposed public method (single)</span>
</span><span class="line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">myFunc</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And our more complicate example, with multiple dependencies and multiple exposed methods:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="c1">//    filename: foo.js</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery&#39;</span><span class="p">);</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;underscore&#39;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="c1">//    methods</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">a</span><span class="p">(){};</span>    <span class="c1">//    private because it&#39;s omitted from module.exports (see below)</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">b</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s defined in module.exports</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">c</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s defined in module.exports</span>
</span><span class="line">
</span><span class="line"><span class="c1">//    exposed public methods</span>
</span><span class="line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span>
</span><span class="line">    <span class="nx">c</span><span class="o">:</span> <span class="nx">c</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="umd-universal-module-definition">UMD: Universal Module Definition</h2>

<p>Since CommonJS and AMD styles have both been equally popular, it seems there’s yet no consensus.  This has brought about the push for a “universal” pattern that supports both styles, which brings us to none other than the Universal Module Definition.</p>

<p>The pattern is admittedly ugly, but is both AMD and CommonJS compatible, as well as supporting the old-style “global” variable definition:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// AMD</span>
</span><span class="line">        <span class="nx">define</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">],</span> <span class="nx">factory</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// Node, CommonJS-like</span>
</span><span class="line">        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery&#39;</span><span class="p">));</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// Browser globals (root is window)</span>
</span><span class="line">        <span class="nx">root</span><span class="p">.</span><span class="nx">returnExports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">jQuery</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">//    methods</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">myFunc</span><span class="p">(){};</span>
</span><span class="line">
</span><span class="line">    <span class="c1">//    exposed public method</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">myFunc</span><span class="p">;</span>
</span><span class="line"><span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And keeping in the same pattern as the above examples, the more complicated case with multiple dependencies and multiple exposed methods:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// AMD</span>
</span><span class="line">        <span class="nx">define</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">,</span> <span class="s1">&#39;underscore&#39;</span><span class="p">],</span> <span class="nx">factory</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// Node, CommonJS-like</span>
</span><span class="line">        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery&#39;</span><span class="p">),</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;underscore&#39;</span><span class="p">));</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="c1">// Browser globals (root is window)</span>
</span><span class="line">        <span class="nx">root</span><span class="p">.</span><span class="nx">returnExports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nx">root</span><span class="p">.</span><span class="nx">_</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">//    methods</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">a</span><span class="p">(){};</span>    <span class="c1">//    private because it&#39;s not returned (see below)</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">b</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s returned</span>
</span><span class="line">    <span class="kd">function</span> <span class="nx">c</span><span class="p">(){};</span>    <span class="c1">//    public because it&#39;s returned</span>
</span><span class="line">
</span><span class="line">    <span class="c1">//    exposed public methods</span>
</span><span class="line">    <span class="k">return</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span>
</span><span class="line">        <span class="nx">c</span><span class="o">:</span> <span class="nx">c</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>(Sep 2014 edit: fixed syntax for CommonJS in the last example)</p>
</div>



<section id="comment">
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</article></div>
	<footer id="footer" class="inner" role="contentinfo"><br>
<br>
<br>
<br>
&copy; 2016
<span itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="David Calhoun"><a href="mailto:david.b.calhoun@gmail.com" itemprop="email">David Calhoun</a> (<a href="https://twitter.com/franksvalli" itemprop="url">@franksvalli</a>) - <a href="https://www.linkedin.com/in/davidcalhoun" itemprop="url">LinkedIn</a> - <a href="http://themaingate.net/resume/" itemprop="url">Resume</a></span></footer>
	<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script> -->
<!-- <script src="/javascripts/hyphenator.js"></script> -->


<script type="text/javascript">
      var disqus_shortname = 'davidbcalhoun';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://davidbcalhoun.com/2014/what-is-amd-commonjs-and-umd/';
        var disqus_url = 'http://davidbcalhoun.com/2014/what-is-amd-commonjs-and-umd/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script src="/javascripts/main.js" defer></script>
<!-- <script src="/javascripts/negative-scroll-blur.js"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5530615-3', 'davidbcalhoun.com');
  ga('send', 'pageview');

</script>

</body>
</html>
