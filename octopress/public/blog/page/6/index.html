
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>  | David Calhoun's blog</title>

	<meta name="author" content="David Calhoun">

<meta name="description" content="Alex Kessinger tweeted asking if there was a reason to still use EMs instead of PX measurements in mobile. This is an interesting question, but 140 &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="David Calhoun's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="/javascripts/html5.js"></script><![endif]-->
	

</head>



<body>
	<header id="header" class="inner"><h1><a href="/">David Calhoun's blog</a></h1>
<span class="tagline"></span>
<!-- <nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav> -->
<!-- <nav id="mobile-nav"> -->
<!-- 	<div class="alignleft menu"> -->
<!-- 		<a class="button">Menu</a> -->
<!-- 		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</div> -->
<!-- 	</div> -->
<!-- </nav> -->


</header>

	<div id="content" class="inner">


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/does-it-still-make-sense-to-use-em-rather-than-px">
			
				Does It Still Make Sense to Use Em Rather Than Px?</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-10-05T00:00:00-07:00" pubdate data-updated="true">Oct 5<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<p>Alex Kessinger <a href="http://twitter.com/voidfiles/status/26470129747">tweeted</a> asking if there was a reason to still use EMs instead of PX measurements in mobile. This is an interesting question, but 140 characters isn’t quite enough to explain my thoughts. So here’s an old-fashioned blog post!</p>

<p>Just a quick review: em and percentage (%) units in CSS are relative measurements, whereas px and other measurements are not. What this means is that the resulting size of relative measurements depends on the size of the parent.</p>

<h3 id="the-original-reason-to-use-ems-instead-of-px-measurements">The original reason to use EMs instead of PX measurements</h3>

<p>As far as I can tell, the original reason why it became a good practice to use EMs was because of page scaling and accessibility reasons. When developers used PX measurements, they found that when the page was scaled (using Ctrl + Scroll Wheel), the parts of the page with fixed PX measurements didn’t scale.</p>

<p>Oh no! So when a user with poor eyesight tried to scale a page to read the text better, it turns out that the text they were interesting in making bigger actually didn’t change size at all!</p>

<p>So is this still the case today? By and large, no. All modern browsers except IE6 will now scale pages correctly, regardless of the type of CSS units used.</p>

<p>From what I’ve heard, there are still many users with disabilities using IE6, but the reason is because they don’t want to upgrade their copy of the screen reader JAWS, which is quite expensive. However, these users obviously aren’t affected by page scaling issues because they are blind.</p>

<h3 id="maintainability-concerns">Maintainability concerns</h3>

<p>Even if the original reason to use EMs (above) is no longer valid, I still believe there are good reasons to use them.</p>

<p>One of the main reasons is maintainability. If a page is designed to have one base font size (applied to the Body) and all other font sizes on the page use relative units (EMs or percentages), changing the font sizes later becomes almost trivial. If someone wants to later increase the size of the fonts on their entire page, all they need to do is increase the one base font size.</p>

<p>This might be a bit of an edge case, but the elegance of the solution is too enticing!</p>

<h3 id="media-queries-and-mobile">Media queries and mobile</h3>

<p>Very closely related to the above point is the subject of media queries. Recently media queries have been somewhat hailed as a <a href="http://www.quirksmode.org/blog/archives/2010/09/rethinking_the.html">panacea for all mobile development</a>. I slightly disagree, but that’s a topic for another post!</p>

<p>The main point here is that people are now using media queries to quickly make mobile-friendly versions of their desktop websites. That’s awesome, there’s no doubt about that.</p>

<p>So what about EMs and PX measurements? Here’s the problem: if a developer coded their webpage in such a way that they used fixed pixel measurements, the amount of CSS required in the mobile media query could be obscenely large. This is because each individual element with pixel measurement was <em>designed with the desktop in mind</em>! This makes the task of adapting to different content very painful.</p>

<p>On the other hand, think about a page designed with relative units such as EMs or percentages. This page was designed so that each element was proportional to its parent element, so that ideally changing the size of the entire page occurs in only a few places, at the Body level of the document. Suddenly the CSS required for the mobile media query is much more manageable, since it’s now (ideally) only changing a few values on the Body element, not on <em>every</em> element on the page.</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/mobile-monday-best-practices-mobile-design-september-20-2010">
			
				Mobile Monday: Best Practices for Mobile Design (September 20, 2010)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-09-21T00:00:00-07:00" pubdate data-updated="true">Sep 21<span>st</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<p><a href="http://davidbcalhoun.com/wp-content/uploads/2010/09/momo.jpg"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/09/momo-1024x768.jpg" alt="" title="momo" width="100%" class="size-large wp-image-464" /></a><em>Mobile Monday panel left to right: Wesley Yun (RIM), Jared Benson (Punchcut), Anne Sullivan (Microsoft/Tellme Networks), Chris Nesladek (Google), Sue Booker (Nokia) (taken with my iPhone 3GS)</em></p>

<p>I just came back from <a href="http://www.mobilemonday.us/?p=424">Mobile Monday Silicon Valley: Best Practices for Mobile Design</a> at the <a href="http://www.computerhistory.org/">Computer History Museum</a> in Mountain View. This was a panel discussion with representatives from Google, Microsoft, Nokia, RIM, and Punchcut. There were quite a few little nuggets of wisdom which I tried to write down in bullet form:</p>

<h4 id="sue-booker-ued-nokia">Sue Booker, UED (Nokia)</h4>

<ul>
  <li>1 trillion revenue worldwide from disabled users. 60m disabled users in the US.</li>
  <li>assume the user is multitasking</li>
  <li>apps will be used in totally unexpected ways</li>
  <li>not just physical disabilities.. also people in different situations or environmental limitations (no voice, no audio, limited bandwidth, etc)</li>
  <li>introduce new complicated functionality gradually. It’s easy to tell if it’s a new user or a repeat user, so slowly give repeat users more info.</li>
  <li>final takeaway: think of all types of users</li>
</ul>

<h4 id="chris-nesladek-commerce-ui-lead-google">Chris Nesladek, Commerce UI Lead (Google)</h4>

<ul>
  <li>
    <ol>
      <li>keep it simple</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>content is king</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>make it fun</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>make it fast</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>do one thing as an experiment</li>
    </ol>
  </li>
  <li>new UI challenge in the future: flexible screens?</li>
  <li>discoverability of new features… for an Android feature: link to video demo on vimeo</li>
  <li>final takeaway: designers, make friends with developers, because that’s how the best products get made</li>
</ul>

<h4 id="anne-sullivan-ui-designer-microsofttellme-networks">Anne Sullivan, UI Designer (Microsoft/Tellme Networks)</h4>

<ul>
  <li>her focus: designing for speech on mobile</li>
  <li>problem: discoverability of speech</li>
  <li>understand the capabilities and limitations of speech</li>
  <li>graceful degradation for speech: what happens when a voice command isn’t recognized?</li>
  <li>be transparent about what happens about processing in the background. For instance, geolocation. Allow the user to change or override this info.</li>
  <li>paper prototypes are very helpful</li>
  <li>discoverability of voice command activation is hard.. have to test on device itself (i.e. to find the right button placement, etc.)</li>
  <li>final takeaway: forget powerpoint! do presentations on the phone itself</li>
</ul>

<h4 id="jared-benson4-design-punchcut"><a href="http://twitter.com/benson">Jared Benson</a>, Design (Punchcut)</h4>

<ul>
  <li>iterate quickly</li>
  <li>no substitute for device itself</li>
  <li>final takeaway: involve designers from the beginning</li>
</ul>

<h4 id="wesley-yun5-ux-rim"><a href="http://twitter.com/nuysew">Wesley Yun</a>, UX (RIM)</h4>

<ul>
  <li>don’t make assumptions about touch interfaces (common gestures). The touchscreen is still pretty new, so not everyone is used to this yet</li>
  <li>don’t be too clever for your users. Think of users first, and do what makes sense.</li>
  <li>prototype and fail quickly. If you’re not failing, you’re not innovating</li>
  <li>make sure unusual new interaction isn’t a core functionality (for instance, four-fingered scroll)</li>
  <li>if you make something redundant, you’ve failed as a designer</li>
  <li>final takeaway: make it obvious to users</li>
</ul>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/server-side-console-log">
			
				Server Side console.log</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-09-15T00:00:00-07:00" pubdate data-updated="true">Sep 15<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="the-problem">The problem</h3>

<p>On the desktop we’re quite privileged to have nice debugging tools such as Firebug and Web Inspector in Webkit-based browsers. But when it comes to mobile, debugging JavaScript with</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          console.log
        </div>
      </td>
    </tr>
  </table>
</div>

<p>isn’t quite as easy.</p>

<p>Probably the best available tool on mobile at the moment is mobile Safari’s console, which looks like the following when enabled (Settings -&gt; Safari -&gt; Developer -&gt; Debug Console):<br />
&lt;div id=&#8221;attachment_453&#8221; style=&#8221;width: 710px&#8221; class=&#8221;wp-caption aligncenter&#8221;&gt;
  <img src="http://davidbcalhoun.com/wp-content/uploads/2010/09/mobile-safari-console.png" alt="" title="mobile-safari-console" width="700" height="480" class="size-full wp-image-453" />&lt;p class=&#8221;wp-caption-text&#8221;&gt;
    Mobile Safari’s debug console
  &lt;/p&gt;
&lt;/div&gt;</p>

<p>On the left you can see the debug console displayed above the document itself, and on the right is an example of what you might see after outputting an object or a string of text to</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          console.log
        </div>
      </td>
    </tr>
  </table>
</div>

<p>. It’s the best debugging tool on mobile, but it’s not without its issues.</p>

<p>The first issue is that the debug console is taking up space in the screen and interfering with how an actual user would view the website. I could image this could become particularly annoying when trying to develop a web app in the style of the new YouTube mobile, which doesn’t function like a traditional webpage at all, and relies on the screen being a certain height in order to display its content.</p>

<p>The second issue is that you can’t see the contents of JavaScript Objects. We’re a bit spoiled being able to see a tree view of objects on the latest browsers with the latest debugging tools, and therefore it makes the experience on mobile Safari less than adequate. When we type</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          console.log(navigator)
        </div>
      </td>
    </tr>
  </table>
</div>

<p>all we can see on mobile Safari is</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          [object Navigator]
        </div>
      </td>
    </tr>
  </table>
</div>

<p>, which leaves something to be desired.</p>

<p>So what about Android? Google offers something called <a href="http://developer.android.com/guide/developing/tools/adb.html">Android Debug Bridge</a>, which is a client-server debugging solution that can be used either for web or application development. As such, when you view the messages the devices sends to the server, the vast majority of messages will be messages about low-level operations, stuff we usually don’t care much about when developing with JavaScript. The workaround for this is to grep for “console” on the command line, which will only display the messages we’re interested in.</p>

<h3 id="the-solution-server-side-consolelog">The solution: server side console.log!</h3>

<p>Why not just send the contents of your console message to a server, and have it log it? The concept is pretty simple:</p>

<ol>
  <li>Create a log function that sends an XHR to a server.</li>
  <li>Have the server process the request and log the message to a file.</li>
  <li>Tail the end of the file on the command line to see the latest messages.</li>
</ol>

<p>The implementation is pretty simple. In JavaScript we have this code:</p>

<pre name="code" class="JScript">(function(){

// define console if not already defined
console || (console = {});

// new toFile method
console.toFile = function(log) {
  // variable declarations
  var http, url, params;
  
  // might as well use the traditional console.log() as well
  console.log(log);
  
  // ajax request
  http = new XMLHttpRequest();
  url = "//example.com/log.php";
  params = "log=" + Date.now() + ' ' + escape(sanitize(log));
  http.open("POST", url, true);
  http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  http.send(params);
}

// do something special if txt is an object
var sanitize = function(txt) {
  var output, x;
  
  if(typeof txt == 'object') {
    // create a new object to get around circular references
    output = {};
    for(x in txt) {
        // type conversion of each element to a string
        output[x] = txt[x] + '';
    }
    output = JSON.stringify(output, null, 2);
  } else {
    output = txt;
  }
  
  return output;
}

})();
</pre>

<p>In summary, the above code adds a new method to the console object called</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          toFile
        </div>
      </td>
    </tr>
  </table>
</div>

<p>, which simply takes the inputted data and sends it to the specified URL. The only bit of trickery here is the function</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          sanitize
        </div>
      </td>
    </tr>
  </table>
</div>

<p>, which detects if the message being passed in is an object. If it is, it copies it to a new object containing only strings (which gets around JSON “circular reference” errors) and runs JSON.stringify() on it, which lets us peek into its contents one level deep.</p>

<p>The server side PHP code to make this work is even simpler:</p>

<pre name="code" class="PHP">// log.php
&lt;?php

// take advantage of error_log to log the message to the file console.log
@error_log($_POST['log'] . "\n", 3, 'console.log');

?&gt;
</pre>

<p>On the server, we log in with terminal, navigate to the directory containing the file console.log, and simply tail the end of the file, which shows live updates as new messages are added to the end of the file:</p>

<pre name="code">tail -f console.log
</pre>

<h3 id="example">Example</h3>

<p>Once we have the above code in place, using the console is very simple:</p>

<pre name="code" class="JScript">console.toFile('hello world!');
console.toFile(navigator);
</pre>

<p>After running this code, you should see this pop up on your terminal:</p>

<pre name="code">1284574866900 hello world!
1284575008914 {
  "geolocation": "[object Geolocation]",
  "standalone": "false",
  "cookieEnabled": "true",
  "language": "en-us",
  "productSub": "20030107",
  "product": "Gecko",
  "appCodeName": "Mozilla",
  "mimeTypes": "[object MimeTypeArray]",
  "vendorSub": "",
  "vendor": "Apple Computer, Inc.",
  "platform": "iPhone",
  "appName": "Netscape",
  "appVersion": "5.0 (iPhone; U; CPU iPhone OS 4_1 like Mac OS X; en-us) AppleWebKit/532.9 (KHTML, like Gecko) Version/4.0.5 Mobile/8B117 Safari/6531.22.7",
  "userAgent": "Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_1 like Mac OS X; en-us) AppleWebKit/532.9 (KHTML, like Gecko) Version/4.0.5 Mobile/8B117 Safari/6531.22.7",
  "plugins": "[object PluginArray]",
  "onLine": "true",
  "javaEnabled": "function javaEnabled() {\n    [native code]\n}",
  "getStorageUpdates": "function getStorageUpdates() {\n    [native code]\n}",
  "registerProtocolHandler": "function registerProtocolHandler() {\n    [native code]\n}",
  "registerContentHandler": "function registerContentHandler() {\n    [native code]\n}"
}
</pre>

<p>Sweet! Now we can easily see console messages from <em>actual devices</em>. You can potentially use this code to log Events as they occur (on click or touch interactions) and view the actual x/y coordinate values as they’re being detected on the device!</p>

<h3 id="related">Related</h3>

<p>Alex Kessinger implemented a <a href="http://alexkessinger.net/story/one-file-remote-consolelog-using-nodejs">similar concept with node.js running locally</a></p>

<h3 id="update">Update</h3>

<p>It turns out that Joe Hewitt did this before me with his <a href="http://www.joehewitt.com/blog/firebug_for_iph.php">“Firebug for iPhone”</a>. I have no idea why it took me so long to find this!</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/using-navigator-connection-android">
			
				Optimizing Based on Connection Speed: Using navigator.connection on Android 2.2+</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-09-14T00:00:00-07:00" pubdate data-updated="true">Sep 14<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="introduction">Introduction</h3>

<p>A little while back <a href="http://www.mobilexweb.com/blog/android-froyo-html5-accelerometer-flash-player">this post</a> made the rounds, which took us on a journey through some of the new features introduced in the browser in Android 2.2 Froyo. Among the most overlooked features are the file upload functionality (you can upload photos from your browser now! But we’re still waiting on iPhone to support this…) and a little-known JavaScript addition to the Browser Object Model (BOM) in the form of</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          navigator.connection
        </div>
      </td>
    </tr>
  </table>
</div>

<p>. Let’s take a peek at its contents:</p>

<pre name="code" class="JScript">// contents of navigator.connection object
{
  "type": "3",
  "UNKNOWN": "0",
  "ETHERNET": "1",
  "WIFI": "2",
  "CELL_2G": "3",
  "CELL_3G": "4"
}
</pre>

<p>This is data taken from a Nexus One running on a 2G network, so you can see that the type is set to 3, which corresponds with “CELL_2G”. In other words, this phone runs on a slower network, so from a performance perspective, you probably want to consider delivering a lower-bandwidth experience.</p>

<p>So how exactly do we target this?</p>

<h3 id="the-code">The code</h3>

<p>The purpose of this code is to first find the connection speed, and then add a class to the</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          html
        </div>
      </td>
    </tr>
  </table>
</div>

<p>element based on this connection. The goal is to be able to target these connections with CSS, so the right content is delivered to the right connection:</p>

<pre name="code" class="CSS">.highbandwidth .logo   { background-image:url('logo-high.jpg'); }
.mediumbandwidth .logo { background-image:url('logo-medium.jpg'); }
.lowbandwidth .logo    { background-image:url('logo-low.jpg'); }
</pre>

<p>And here’s the JavaScript:</p>

<pre name="code" class="JScript">var connection, connectionSpeed, htmlNode, htmlClass;

// create a custom object if navigator.connection isn't available
connection = navigator.connection || {'type':'0'};

// set connectionSpeed
switch(connection.type) {
  case connection.CELL_3G:
    // 3G
    connectionSpeed = 'mediumbandwidth';
  break;
  case connection.CELL_2G:
    // 2G
    connectionSpeed = 'lowbandwidth';
  break;
  default:
    // WIFI, ETHERNET, UNKNOWN
    connectionSpeed = 'highbandwidth';
}

// set the connection speed on the html element, i.e. &lt;html class="lowbandwidth"&gt;
htmlNode = document.body.parentNode;
htmlClass = htmlNode.getAttribute('class') || '';
htmlNode.setAttribute('class', htmlClass + ' ' + connectionSpeed);
</pre>

<h3 id="give-the-user-control">Give the user control!</h3>

<p>Just as it’s a good practice to give the user a link to the full desktop version of the website, if you’re going to deliver different content based on different connection speeds, then it’s highly advisable to give the user full control.</p>

<p>So give them control! You can provide something like the following:</p>

<div id="bandwidthControls">
  <p>
    Mobile | <a href="#">Desktop</a>
  </p>
  
  <p>
    Bandwidth: <a href="#">High</a> | <a href="#">Medium</a> | Low
  </p>
</div>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/basic-html5-template">
			
				Basic HTML5 Template</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-09-08T00:00:00-07:00" pubdate data-updated="true">Sep 8<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="introduction">Introduction</h3>

<p>Often times I end up creating short pages for testing short pieces of code, and I only need a very basic HTML template to write in. Short of using <a href="http://html5boilerplate.com/">HTML5 Boilerplate</a>, I just use a quick piece of code like the following. (note: yes, this has issues in IE, so you may want to use <a href="http://remysharp.com/2009/01/07/html5-enabling-script/">HTML5 Shiv/Shim</a>)</p>

<h3 id="the-code">The code</h3>

<pre name="code" class="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="utf-8"/&gt;
  &lt;title&gt;&lt;/title&gt;

  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/&gt;
  &lt;link rel="stylesheet" href=""/&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;header&gt;
  &lt;/header&gt;

  &lt;div&gt;
  &lt;/div&gt;

  &lt;footer&gt;
  &lt;/footer&gt;

  &lt;script src=""&gt;&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</pre>

<p>Edit: Self-closed tags for compatibility.<br />
Edit2: removed type=”text/css” from the link tag</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/dealing-with-device-orientation">
			
				Dealing With Device Orientation (Mobile Web Part 6)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-08-24T00:00:00-07:00" pubdate data-updated="true">Aug 24<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="introduction">Introduction</h3>

<p>If you read <a href="http://davidbcalhoun.com/2010/on-designing-a-mobile-webpage">part 4</a> of this series, you’ll know that because of the variety of screen sizes, the best way to develop for mobile is to develop fluid layouts that take 100% of the available space on the screen.</p>

<p>What you probably didn’t think of is that there’s different screen widths <em>even on the same device</em>! This is due to screen orientation. And when the user changes the screen orientation, stuff may break (hey, it’s not a perfect world). In my experience this has meant needing to tweak percentage widths on elements, but I imagine there’s even more needs. Imagine an image carousel that can only fit three images across in portrait mode but can possibly fit four images in landscape mode. It might be nice to re-initialize the carousel to accommodate a forth image when the phone is in landscape mode (then again, that might create a lot of unnecessary overhead…).</p>

<p>In any case, I hope you can agree that it would sometimes be useful to know the screen orientation.</p>

<h3 id="windoworientation-and-the-orientationchange-event"><code>window.orientation</code> and the <code>orientationchange</code> event</h3>
<p>Luckily on the latest smartphones you have some goodies available to you that you don’t have on the desktop (since desktop users aren’t in the habit of constantly turning their screens sideways!).</p>

<ul lang="js">
  <li>
    <p><code>window.orientation</code>: this property gives the current screen orientation: 0 in portrait mode, 90 when rotated left, -90 when rotated right (no special value when the screen is upside-down)</p>
  </li>
  <li>
    <p><code>orientationchange</code> event: this window event fires after every 90 degrees of rotation and, like other events, <a href="http://en.wikipedia.org/wiki/DOM_events">can be applied in various ways</a>:</p>

    <p>// DOM Level 0 (avoid)
  window.onorientationchange = function(){};</p>

    <p>// DOM Level 2
  window.addEventListener(‘orientationchange’, function(){}, false);</p>
  </li>
</ul>

<p><a href="http://www.iphonemicrosites.com/articles/6-tips-to-optimize-your-current-site-for-the-iphone/">Some websites</a> recommend using <code>orientationchange</code> to dynamically add an <code>orient</code> attribute on the <code>body</code> element and target the orientation with CSS selectors (<code>body[orient=landscape]</code>), <em>but this is in error</em>. As it turns out, <code>orientationchange</code> is only fired AFTER the screen has been rotated (which also <a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/">triggers a CSS reflow</a>), which means this attribute is updated later (after the reflow). And unfortunately editing this <code>orient</code> attribute doesn’t trigger another CSS reflow. The result? When you rotate the device, these new CSS styles don’t get applied!</p>

<p>The fix is to add the orientation as a CSS class, which does trigger a CSS reflow. So our code at this point will look something like this:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
<a href="#n18" name="n18">18</a>
<a href="#n19" name="n19">19</a>
<strong><a href="#n20" name="n20">20</a></strong>
<a href="#n21" name="n21">21</a>
<a href="#n22" name="n22">22</a>
<a href="#n23" name="n23">23</a>
<a href="#n24" name="n24">24</a>
<a href="#n25" name="n25">25</a>
<a href="#n26" name="n26">26</a>
<a href="#n27" name="n27">27</a>
</pre></td>
  <td class="code"><pre>(<span class="keyword">function</span>(){
<span class="keyword">var</span> <span class="function">init</span> = <span class="keyword">function</span>() {
  <span class="keyword">var</span> <span class="function">updateOrientation</span> = <span class="keyword">function</span>() {
    <span class="keyword">var</span> orientation = window.orientation;
    
    <span class="keyword">switch</span>(orientation) {
      <span class="keyword">case</span> <span class="integer">90</span>: <span class="keyword">case</span> -<span class="integer">90</span>:
        orientation = <span class="string"><span class="delimiter">'</span><span class="content">landscape</span><span class="delimiter">'</span></span>;
      <span class="keyword">break</span>;
      <span class="keyword">default</span>:
        orientation = <span class="string"><span class="delimiter">'</span><span class="content">portrait</span><span class="delimiter">'</span></span>;
    }
    
    <span class="comment">// set the class on the HTML element (i.e. )</span>
    document.body.parentNode.setAttribute(<span class="string"><span class="delimiter">'</span><span class="content">class</span><span class="delimiter">'</span></span>, orientation);
  };
  
  <span class="comment">// event triggered every 90 degrees of rotation</span>
  window.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">orientationchange</span><span class="delimiter">'</span></span>, updateOrientation, <span class="predefined-constant">false</span>);
  
  <span class="comment">// initialize the orientation</span>
  updateOrientation();
}

window.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">DOMContentLoaded</span><span class="delimiter">'</span></span>, init, <span class="predefined-constant">false</span>);

})();
</pre></td>
</tr></table>
</div>

<p>Now we can target elements like this in CSS:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre><span class="class">.portrait</span> <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">10%</span>; }
<span class="class">.landscape</span> <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">15%</span>; }
</pre></td>
</tr></table>
</div>

<h3 id="with-a-little-help-from-media-queries">With a little help from media queries</h3>

<p>You may have heard of <a href="https://developer.mozilla.org/en/css/media_queries">media queries</a> being used to target mobile devices (based on screen pixel width) or to <a href="http://www.bdoran.co.uk/2010/07/19/detecting-the-iphone4-and-resolution-with-javascript-or-php/">target the iPhone 4’s Retina display</a>, but you may not have known that you can also target screen orientation!</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
</pre></td>
  <td class="code"><pre><span class="directive">@media</span> <span class="type">all</span> <span class="error">a</span><span class="error">n</span><span class="error">d</span> (<span class="error">o</span><span class="error">r</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">o</span><span class="error">n</span>: <span class="error">p</span><span class="error">o</span><span class="error">r</span><span class="error">t</span><span class="error">r</span><span class="error">a</span><span class="error">i</span><span class="error">t</span>) {
  <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">10%</span>; }
}

<span class="directive">@media</span> <span class="type">all</span> <span class="error">a</span><span class="error">n</span><span class="error">d</span> (<span class="error">o</span><span class="error">r</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">o</span><span class="error">n</span>: <span class="error">l</span><span class="error">a</span><span class="error">n</span><span class="error">d</span><span class="error">s</span><span class="error">c</span><span class="error">a</span><span class="error">p</span><span class="error">e</span>) {
  <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">15%</span>; }
}
</pre></td>
</tr></table>
</div>

<p>The orientation media query is available on iOS 3.2+, Android 2.0+, and some other browsers.</p>

<p>This is a lot cleaner than the above JavaScript example in the sense that it’s pure CSS, and it’s part of the CSS that gets reflowed when the screen is rotated.</p>

<p>(Minor note: iOS 4 on the iPhone Simulator running 4.0.0 looks like it’s stuck in landscape orientation, but the media queries work correctly on my 3GS with 4.0.1)</p>

<h3 id="fallback-when-windoworientation-and-media-queries-arent-available">Fallback: when window.orientation and media queries aren’t available…</h3>

<p>If <code>window.orientation</code> isn’t available on a device, chances are the <code>orientationchange</code> event and media queries (for orientation) will also not be available.  Oh no, what do we do now?</p>

<p>Even though this isn’t an entirely foolproof method, we can dynamically measure the window width and height and guess orientation based on that:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
<a href="#n18" name="n18">18</a>
</pre></td>
  <td class="code"><pre>(<span class="keyword">function</span>(){
<span class="keyword">var</span> HTMLNode = document.body.parentNode;
<span class="keyword">var</span> <span class="function">updateOrientation</span> = <span class="keyword">function</span>() {  
  <span class="comment">// landscape when width is biggest, otherwise portrait</span>
  <span class="keyword">var</span> orientation = (window.innerWidth &gt; window.innerHeight) ? <span class="string"><span class="delimiter">'</span><span class="content">landscape</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">portrait</span><span class="delimiter">'</span></span>;
  
  <span class="comment">// set the class on the HTML element (i.e. )</span>
  HTMLNode.setAttribute(<span class="string"><span class="delimiter">'</span><span class="content">class</span><span class="delimiter">'</span></span>, orientation);
}
<span class="keyword">var</span> <span class="function">init</span> = <span class="keyword">function</span>() {
  <span class="comment">// initialize the orientation</span>
  updateOrientation();
  
  <span class="comment">// update every 5 seconds</span>
  setInterval(updateOrientation, <span class="integer">5000</span>);
}
window.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">DOMContentLoaded</span><span class="delimiter">'</span></span>, init, <span class="predefined-constant">false</span>);
})();
</pre></td>
</tr></table>
</div>

<p>Ok, so it’s not pretty, but it seems to work.  The overhead in this fallback example is the fact that we have to use a polling technique (in this case every 5 seconds [5000 milliseconds]) to check for changes in orientation.</p>

<p>Note: there’s also the strong possibility that these browsers will not support the <code>DOMContentLoaded</code> event, but we’ll ignore that for the purposes of this article. (if you have problems, change <code>DOMContentLoaded</code> to <code>load</code>).</p>

<h3 id="putting-it-all-together">Putting it all together</h3>

<p>Ok, so if you want the fallback example to work in addition to newer methods, unless you want to duplicate your CSS, then avoid using media queries to target orientation.  Instead we’ll rely on adding a class to the <code>html</code> tag (or the <code>body</code> tag if you prefer).</p>

<p>Once we put everything together, we get something that looks like this:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
<a href="#n18" name="n18">18</a>
<a href="#n19" name="n19">19</a>
<strong><a href="#n20" name="n20">20</a></strong>
<a href="#n21" name="n21">21</a>
<a href="#n22" name="n22">22</a>
<a href="#n23" name="n23">23</a>
<a href="#n24" name="n24">24</a>
<a href="#n25" name="n25">25</a>
<a href="#n26" name="n26">26</a>
<a href="#n27" name="n27">27</a>
<a href="#n28" name="n28">28</a>
<a href="#n29" name="n29">29</a>
<strong><a href="#n30" name="n30">30</a></strong>
<a href="#n31" name="n31">31</a>
<a href="#n32" name="n32">32</a>
<a href="#n33" name="n33">33</a>
<a href="#n34" name="n34">34</a>
<a href="#n35" name="n35">35</a>
<a href="#n36" name="n36">36</a>
<a href="#n37" name="n37">37</a>
<a href="#n38" name="n38">38</a>
<a href="#n39" name="n39">39</a>
<strong><a href="#n40" name="n40">40</a></strong>
<a href="#n41" name="n41">41</a>
<a href="#n42" name="n42">42</a>
<a href="#n43" name="n43">43</a>
<a href="#n44" name="n44">44</a>
<a href="#n45" name="n45">45</a>
<a href="#n46" name="n46">46</a>
</pre></td>
  <td class="code"><pre>(<span class="keyword">function</span>(){
<span class="keyword">var</span> supportsOrientation = (<span class="keyword">typeof</span> window.orientation == <span class="string"><span class="delimiter">'</span><span class="content">number</span><span class="delimiter">'</span></span> &amp;&amp; <span class="keyword">typeof</span> window.onorientationchange == <span class="string"><span class="delimiter">'</span><span class="content">object</span><span class="delimiter">'</span></span>);
<span class="keyword">var</span> HTMLNode = document.body.parentNode;
<span class="keyword">var</span> <span class="function">updateOrientation</span> = <span class="keyword">function</span>() {
  <span class="comment">// rewrite the function depending on what's supported</span>
  <span class="keyword">if</span>(supportsOrientation) {
    <span class="function">updateOrientation</span> = <span class="keyword">function</span>() {
      <span class="keyword">var</span> orientation = window.orientation;
    
      <span class="keyword">switch</span>(orientation) {
        <span class="keyword">case</span> <span class="integer">90</span>: <span class="keyword">case</span> -<span class="integer">90</span>:
          orientation = <span class="string"><span class="delimiter">'</span><span class="content">landscape</span><span class="delimiter">'</span></span>;
        <span class="keyword">break</span>;
        <span class="keyword">default</span>:
          orientation = <span class="string"><span class="delimiter">'</span><span class="content">portrait</span><span class="delimiter">'</span></span>;
      }
      
      <span class="comment">// set the class on the HTML element (i.e. )</span>
      HTMLNode.setAttribute(<span class="string"><span class="delimiter">'</span><span class="content">class</span><span class="delimiter">'</span></span>, orientation);
    }
  } <span class="keyword">else</span> {
    <span class="function">updateOrientation</span> = <span class="keyword">function</span>() {
      <span class="comment">// landscape when width is biggest, otherwise portrait</span>
      <span class="keyword">var</span> orientation = (window.innerWidth &gt; window.innerHeight) ? <span class="string"><span class="delimiter">'</span><span class="content">landscape</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">portrait</span><span class="delimiter">'</span></span>;

      <span class="comment">// set the class on the HTML element (i.e. )</span>
      HTMLNode.setAttribute(<span class="string"><span class="delimiter">'</span><span class="content">class</span><span class="delimiter">'</span></span>, orientation);
    }
  }
  
  updateOrientation();
}
<span class="keyword">var</span> <span class="function">init</span> = <span class="keyword">function</span>() {
  <span class="comment">// initialize the orientation</span>
  updateOrientation();
  
  <span class="keyword">if</span>(supportsOrientation) {
    window.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">orientationchange</span><span class="delimiter">'</span></span>, updateOrientation, <span class="predefined-constant">false</span>);
  } <span class="keyword">else</span> {
    <span class="comment">// fallback: update every 5 seconds</span>
    setInterval(updateOrientation, <span class="integer">5000</span>);
  }

}
window.addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">DOMContentLoaded</span><span class="delimiter">'</span></span>, init, <span class="predefined-constant">false</span>);
})();
</pre></td>
</tr></table>
</div>

<p>Minified (540 bytes):</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
</pre></td>
  <td class="code"><pre>(<span class="keyword">function</span>(){<span class="keyword">var</span> e=<span class="keyword">typeof</span> window.orientation==<span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>&amp;&amp;<span class="keyword">typeof</span> window.onorientationchange==<span class="string"><span class="delimiter">&quot;</span><span class="content">object</span><span class="delimiter">&quot;</span></span>,f=document.body.parentNode;<span class="keyword">function</span> <span class="function">c</span>(){c=e?<span class="keyword">function</span>(){<span class="keyword">var</span> d=window.orientation;<span class="keyword">switch</span>(d){<span class="keyword">case</span> <span class="integer">90</span>:<span class="keyword">case</span> -<span class="integer">90</span>:d=<span class="string"><span class="delimiter">&quot;</span><span class="content">landscape</span><span class="delimiter">&quot;</span></span>;<span class="keyword">break</span>;<span class="keyword">default</span>:d=<span class="string"><span class="delimiter">&quot;</span><span class="content">portrait</span><span class="delimiter">&quot;</span></span>}f.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span>,d)}:<span class="keyword">function</span>(){f.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">class</span><span class="delimiter">&quot;</span></span>,window.innerWidth&gt;window.innerHeight?<span class="string"><span class="delimiter">&quot;</span><span class="content">landscape</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">portrait</span><span class="delimiter">&quot;</span></span>)};c()}window.addEventListener(<span class="string"><span class="delimiter">&quot;</span><span class="content">DOMContentLoaded</span><span class="delimiter">&quot;</span></span>,<span class="keyword">function</span>(){c();e?window.addEventListener(<span class="string"><span class="delimiter">&quot;</span><span class="content">orientationchange</span><span class="delimiter">&quot;</span></span>,c,<span class="predefined-constant">false</span>):setInterval(c,<span class="float">5E3</span>)},<span class="predefined-constant">false</span>)})();
</pre></td>
</tr></table>
</div>

<h3 id="conclusion">Conclusion</h3>

<p>And that’s it!  Now we can reliably target different screen orientations with some straightforward CSS:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre><span class="class">.portrait</span> <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">10%</span>; }
<span class="class">.landscape</span> <span class="tag">body</span> <span class="tag">div</span> { <span class="key">width</span>: <span class="float">15%</span>; }
</pre></td>
</tr></table>
</div>

<p>Again, in my experience I’ve used this to fix bugs.  But I’m sure you can find more creative uses for it!</p>

<h3 id="related">Related</h3>
<p><a href="http://www.nczonline.net/blog/2010/04/06/ipad-web-development-tips/">iPad web development tips (Nicholas C. Zakas)</a><br />
<a href="http://ajaxian.com/archives/iphone-windowonorientationchange-code">iPhone window.onorientationchange Code (Ajaxian)</a><br />
<a href="http://www.quirksmode.org/blog/archives/2010/04/the_orientation.html">The orientation media query (Quirksmode)</a></p>

<h3 id="more-from-the-mobile-web-series">More from the Mobile Web series:</h3>
<ul>
  <li><a href="http://davidbcalhoun.com/2010/viewport-metatag">Part 1: The viewport metatag</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/the-mobile-developers-toolkit-mobile-web-part-2">Part 2: The mobile developer’s toolkit</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/designing-buttons-that-dont-suck">Part 3: Designing buttons that don’t suck</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/on-designing-a-mobile-webpage">Part 4: On designing a mobile webpage</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/using-mobile-specific-html-css-javascript">Part 5: Using mobile-specific HTML, CSS, and JavaScript</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/dealing-with-device-orientation">Part 6: Dealing with device orientation</a><br /></li>
  <li><a href="http://davidbcalhoun.com/2010/mobile-javascript-libraries-and-frameworks">Part 7: Mobile JavaScript libraries and frameworks</a></li>
</ul>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/blackberry-torch-sunspider-results-javascript-benchmark">
			
				BlackBerry Torch SunSpider Results (JavaScript Benchmark)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-08-18T00:00:00-07:00" pubdate data-updated="true">Aug 18<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="results">Results</h3>

<pre>============================================
RESULTS (means and 95% confidence intervals)
--------------------------------------------
Total:                 322.2ms +/- 4.9%
--------------------------------------------

  3d:                   55.0ms +/- 15.3%
    cube:               19.8ms +/- 12.1%
    morph:              16.6ms +/- 35.8%
    raytrace:           18.6ms +/- 22.5%

  access:               32.8ms +/- 12.4%
    binary-trees:        1.8ms +/- 30.9%
    fannkuch:           14.2ms +/- 7.3%
    nbody:              12.6ms +/- 26.7%
    nsieve:              4.2ms +/- 24.8%

  bitops:               29.4ms +/- 10.2%
    3bit-bits-in-byte:   2.4ms +/- 28.4%
    bits-in-byte:        8.0ms +/- 15.5%
    bitwise-and:         8.6ms +/- 21.9%
    nsieve-bits:        10.4ms +/- 21.7%

  controlflow:           2.4ms +/- 28.4%
    recursive:           2.4ms +/- 28.4%

  crypto:               22.0ms +/- 10.6%
    aes:                 9.8ms +/- 27.5%
    md5:                 6.2ms +/- 22.0%
    sha1:                6.0ms +/- 20.7%

  date:                 33.2ms +/- 11.7%
    format-tofte:       16.6ms +/- 20.2%
    format-xparb:       16.6ms +/- 13.6%

  math:                 32.6ms +/- 15.2%
    cordic:             12.0ms +/- 29.3%
    partial-sums:       15.2ms +/- 20.4%
    spectral-norm:       5.4ms +/- 20.6%

  regexp:               15.6ms +/- 7.1%
    dna:                15.6ms +/- 7.1%

  string:               99.2ms +/- 14.0%
    base64:              9.2ms +/- 14.8%
    fasta:              14.4ms +/- 27.7%
    tagcloud:           27.2ms +/- 23.2%
    unpack-code:        31.8ms +/- 14.5%
    validate-input:     16.6ms +/- 18.0%
</pre>

<h3 id="related-articles">Related articles</h3>

<p><a href="http://davidbcalhoun.com/2010/iphone-4-sunspider-test-results">iPhone 4 SunSpider test results (22% faster than iPhone 3GS)</a><br />
<a href="http://davidbcalhoun.com/2010/sunspider-ios-3-1-3-versus-ios-4-gm">JavaScript SunSpider test: iOS 3.1.3 versus iOS 4 GM</a><br />
<a href="http://davidbcalhoun.com/2010/javascript-sunspider-htc-evo-versus-htc-incredible-versus-nexus-one">JavaScript SunSpider: HTC Evo versus HTC Incredible versus Nexus One</a><br />
<a href="http://www.sencha.com/blog/2010/08/18/blackberry-torch-the-html5-developer-scorecard/">Sencha: BlackBerry Torch: The HTML5 Developer Scorecard</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/is-hash-faster-than-switch-in-javascript">
			
				Is a Hash Faster Than a Switch in JavaScript?</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-08-17T00:00:00-07:00" pubdate data-updated="true">Aug 17<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<p>I stumbled across this concept recently and I thought I’d share it, because I don’t generally see this pattern being used. More importantly, I also share test results that show that maybe it’s not always a good idea to use this pattern…</p>

<h3 id="the-problem-with-switch-statements">The problem with Switch statements</h3>

<p>The basic switch statement in JavaScript looks something like this:</p>

<pre name="code" class="JScript">var foo = 'c';

switch(foo) {
  case 'a':
  break;

  case 'b':
  break;

  case 'c':
  break;

  default:
}
</pre>

<p>So what’s wrong with this? The JS engine has to examine a bunch of unrelated cases until it finds the relevant one, executes the code, then breaks out of the switch because the job is done (this is why it’s important to break!). In the above example we had to go through case A and case B until finally reaching case C. What’s worse is that if it didn’t match any of these cases, the JS engine has to jump through ALL of the cases before it reaches Default, the fall-through case.</p>

<p>Actually it’s not so bad, as long as there are a limited number of cases. It’s probably no big deal if you only have a few cases to jump through. The problem gets bigger as your number of cases increases (some of you may know this as <a href="http://en.wikipedia.org/wiki/Big_O_notation">O(n)</a>). What happens when there’s 10 cases? Then there’s potentially 10 checks on cases (assuming what ended up being executed was the default). 100 cases? Then potentially 100 checks.</p>

<p>What would be better is if there were a way to reduce the number of checks. One way would be to put the most frequently used cases at the top. This would alleviate some of the pain, but you still end up with extra processing while the JS checks each case. It would be ideal to avoid this extra processing altogether.</p>

<h3 id="an-alternative-the-hash-table">An alternative: The hash table</h3>

<p>There is a way to avoid this extra processing! It’s by leading the code directly where it needs to go, without unnecessary checking of unrelated cases.</p>

<p>You can do this using a hash. In JavaScript we accomplish this with an object:</p>

<pre name="code" class="JScript">var foo = 'c';
var cases = {};
cases['a'] = function() {
  alert('I am A!');
};
cases['b'] = function() {
  alert('I am B!');
};
cases['c'] = function() {
  alert('I am C!');
}

if(typeof cases[foo] == 'function') {
  // only executes if we've defined it above
  cases[foo]();  // I am C!
} else {
  // default (the fallthrough)
}
</pre>

<p>There we go! No extra case checking here. We’ve led the JS straight to the code we want to execute!</p>

<h3 id="performance-improvement8230">Performance improvement…?</h3>

<p>So.. this hash lookup seems faster in theory, but what about in practice? Unfortunately I ended up with some mixed results…</p>

<p>I created a <a href="http://jsperf.com/switch-vs-hash/3">simple performance test on jsperf.com</a> and got these results:</p>

<table>
  <tr>
    <td>
      Browser
    </td>
    
    <td>
      Switch ops/sec
    </td>
    
    <td>
      Hash table ops/sec
    </td>
    
    <td>
      % Difference
    </td>
  </tr>
  
  <tr>
    <td>
      Chrome 6.0.490.1 dev
    </td>
    
    <td class="negative">
      34,606,469
    </td>
    
    <td class="positive">
      43,329,587
    </td>
    
    <td class="positive">
      25% faster
    </td>
  </tr>
  
  <tr>
    <td>
      Safari 5.0
    </td>
    
    <td class="positive">
      16,777,216
    </td>
    
    <td class="negative">
      10,854,824
    </td>
    
    <td class="negative">
      35% slower
    </td>
  </tr>
  
  <tr>
    <td>
      Opera 10.61
    </td>
    
    <td class="positive">
      4,405,782
    </td>
    
    <td class="negative">
      2,719,336
    </td>
    
    <td class="negative">
      38% slower
    </td>
  </tr>
  
  <tr>
    <td>
      Firefox 3.6.3
    </td>
    
    <td class="positive">
      2,785,802
    </td>
    
    <td class="negative">
      2,400,586
    </td>
    
    <td class="negative">
      14% slower
    </td>
  </tr>
  
  <tr>
    <td>
      IE6
    </td>
    
    <td class="negative">
      147,870
    </td>
    
    <td class="positive">
      206,869
    </td>
    
    <td class="positive">
      40% faster
    </td>
  </tr>
  
  <tr>
    <td>
      IE7
    </td>
    
    <td class="negative">
      144,735
    </td>
    
    <td class="positive">
      191,179
    </td>
    
    <td class="positive">
      32% faster
    </td>
  </tr>
  
  <tr>
    <td>
      IE8
    </td>
    
    <td class="negative">
      350,085
    </td>
    
    <td class="positive">
      472,417
    </td>
    
    <td class="positive">
      35% faster
    </td>
  </tr>
  
  <tr>
    <td>
      Mobile Safari (iOS4 on iPhone 3GS)
    </td>
    
    <td class="positive">
      668,053
    </td>
    
    <td class="negative">
      416,366
    </td>
    
    <td class="negative">
      37% slower
    </td>
  </tr>
  
  <tr>
    <td>
      Android (2.2 on Nexus One)
    </td>
    
    <td class="negative">
      605,693
    </td>
    
    <td class="positive">
      864,591
    </td>
    
    <td class="positive">
      42% faster
    </td>
  </tr>
</table>

<ul>
  <li>Ops/sec = Operations per second. Higher is better<br />
** Chrome, Safari, Opera, and Firefox were tested on Mac OSX 10.6.4 2.53GHz Intel Core i5. IE tests were run on Windows 7 64bit 2.4GHz Quad Core</li>
</ul>

<h3 id="the-results">The Results</h3>

<p>From the results, it looks like the hash optimization is only a benefit for Chrome, IE6-IE8, and Android. That’s quite a specific sampling. My guess is that the other browsers have implemented some sort of Switch statement optimizations that actually turn the hash optimization into an antipattern.</p>

<h3 id="more-info">More info</h3>

<p>Although I first read about this online, by no surprise this trick also appears in <a href="http://www.nczonline.net/">Nicholas Zakas’s</a> <a href="http://www.amazon.com/Performance-JavaScript-Faster-Application-Interfaces/dp/059680279X">High Performance JavaScript</a> in a section on “Lookup Tables” (p. 72).</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/open-web-camp-ii-stanford">
			
				Open Web Camp II at Stanford (July 17, 2010)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-07-17T00:00:00-07:00" pubdate data-updated="true">Jul 17<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<p>Open Web Camp II at Stanford today was a blast! Lots of information. Plenty I’m already familiar with, but also lots I learned.</p>

<p>I woke up late, only to see people tweeting about the conference (doh!), so I missed seeing Molly Holzschlag. But I arrived just in time to see…</p>

<h3 id="estelle-weyl-8220css3-implementable-features8221">Estelle Weyl: “CSS3 Implementable Features”</h3>

<div class="image-block full">
  <a href="http://www.flickr.com/photos/franksvalli/4803724562/"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/07/owc2-1.jpg" alt="Estelle Weyl" title="Estelle Weyl" width="800" height="676" class="aligncenter size-full wp-image-373" /></a><cite>Estelle Weyl (<a href="http://twitter.com/estellevw">@estellevw</a>)</cite>
</div>

<p>Estelle’s talk was about what features of CSS3 are available to use right now. She covered all the usual: border radius, text shadow, box shadow, tilted images, etc. And she showed off Paul Irish’s <a href="http://css3please.com/">css3please.com</a>, which greatly helps implement these cross-browser, with even the filter hacks required to pull it off in IE! (no word about the performance hit of these IE hacks, which I’m sure I’ve read about somewhere…)</p>

<p>One of the cool new things I learned was that you can use CSS shorthands to declare border-radius (rounded corner) values. So instead of this mess (courtesy of <a href="http://border-radius.com/">border-radius.com</a>):</p>

<pre name="code" class="css">-webkit-border-top-left-radius: 1px;
-webkit-border-top-right-radius: 2px;
-webkit-border-bottom-right-radius: 3px;
-webkit-border-bottom-left-radius: 4px;
-moz-border-radius-topleft: 1px;
-moz-border-radius-topright: 2px;
-moz-border-radius-bottomright: 3px;
-moz-border-radius-bottomleft: 4px;
border-top-left-radius: 1px;
border-top-right-radius: 2px;
border-bottom-right-radius: 3px;
border-bottom-left-radius: 4px;
</pre>

<p>All you need to do is this, which is equivalent to the above (disclaimer: I’m not sure about the compatibility of this shorthand!):</p>

<pre name="code" class="css">-moz-border-radius: 10px 20px 30px 40px;
-webkit-border-radius: 10px 20px 30px 40px;
border-radius: 10px 20px 30px 40px;
</pre>

<p>Or if you get bored of doing a perfectly rounded border radius, you can also do elliptical border radius (again, I’m unsure about the compatibility!):</p>

<pre name="code" class="css">-moz-border-radius: 20px / 10px;
-webkit-border-radius: 20px / 10px;
border-radius: 20px / 10px;
</pre>

<h3 id="matt-henry-8220going-mobile8221">Matt Henry: “Going Mobile”</h3>

<div class="image-block full">
  <a href="http://www.flickr.com/photos/franksvalli/4803731530/"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/07/owc2-2.jpg" alt="Matt Henry" title="Matt Henry" width="800" height="533" class="aligncenter size-full wp-image-374" /></a><cite>Matt Henry (<a href="http://twitter.com/greenideas">@greenideas</a>)</cite>
</div>

<p>I’ve worked closely with Matt at <a href="http://mobile.yahoo.com/">Yahoo! Mobile</a> for the past year, so not much was new for me. It seemed that the audience really dug the talk though (lots of questions were asked!).</p>

<p>Essentially, Matt explained that you have to make at least two different versions of your website: one for feature phones and one for smartphones like the iPhone, and with the help of something like <a href="http://wurfl.sourceforge.net/">WURFL</a>, detect the phone and direct the user to the appropriate site.</p>

<p>Matt also emphasized that feature phone browsers are terrible, much worse than IE6.</p>

<p>As part of a response to someone’s question, Matt talked about the idea of feature detection on smart phones, essentially saying that by the time you’ve sent the JavaScript feature detection to the device, it’s already too late, and in some cases might end up crashing the browser (for feature phones that have an extremely small page weight such as 9KB). So for now it looks like user agent sniffing on the server-side is the way to go.</p>

<p>And there was a brief shoutout for <a href="http://mobile.yahoo.com/developers">Yahoo! Blueprint</a>, which renders a website across thousands of phones.</p>

<h3 id="victor-tsaran-and-todd-kloots-8220accessibility-1018243">Victor Tsaran and Todd Kloots: “Accessibility 101″</h3>

<div class="image-block full">
  <a href="http://www.flickr.com/photos/franksvalli/4803726232/"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/07/owc2-3.jpg" alt="Victor Tsaran (left) and Todd Kloots (right)" title="Victor Tsaran (left) and Todd Kloots (right)" width="800" height="540" class="aligncenter size-full wp-image-375" /></a><cite>Victor Tsaran (<a href="http://twitter.com/vick08">@vick08</a>) and Todd Kloots (<a href="http://twitter.com/todd">@todd</a>)</cite>
</div>

<p>Before joining Twitter, Todd Kloots spent some time with Victor Tsaran at Yahoo! on accessibility.</p>

<p>In this talk they went over common misunderstandings and showed that even today, big companies such as <a href="http://digg.com">Digg.com</a> are still not investing in making their site accessible.</p>

<p>This was a pretty high level overview of basic accessibility, including an introduction to screen readers and ARIA attributes.</p>

<p>Here’s some of the stuff covered:<br />
-making forms accessible with fieldset and legend elements and linking captions to their inputs.<br />
-adding alt tags to images even if blank (so the screen reader doesn’t announce the entire URL)<br />
-the title tag doesn’t make things more accessible, whereas the alt tag does<br />
-screen readers obey display: none and visibility: hidden and that to hide something from normal users you have to position it offscreen (with negative left or text-indent).<br />
-how to make basic tables accessible by taking advantage of table summary and caption, as well as putting tables headings into the &lt;thead&gt; element.</p>

<p>I’m still trying to absorb it, but Todd also mentioned that a simple anchor tag for a button didn’t semantically make sense, and that it was more semantic to have a span wrapped around a &lt;button&gt;. I guess I either don’t understand fully or I just disagree, since a &lt;button&gt; appears within a form and sometimes it just may be a cleaner solution to use a simple anchor tag. I guess I will need to look into this more.</p>

<h3 id="joseph-r-lewis-8220refactoring-for-mobile8221">Joseph R. Lewis: “Refactoring for Mobile”</h3>

<div class="image-block full">
  <a href="http://www.flickr.com/photos/franksvalli/4803099119/"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/07/owc2-4.jpg" alt="Joseph R. Lewis" title="Joseph R. Lewis" width="800" height="533" class="aligncenter size-full wp-image-376" /></a><cite>Joseph R. Lewis (<a href="http://twitter.com/sanbeiji">@sanbeiji</a>)</cite>
</div>

<p>This talk was basically a live demo of implementing CSS media queries in a WordPress installation to make an iPhone-friendly version of the site. There was a good use of the viewport tag, media queries, @font-face, text-shadow, box-shadow, border-radius, etc.</p>

<p>One surprising thing I learned was that apparently Mobile Safari recognizes border-radius without the webkit prefix? I’m going to follow up on this.</p>

<h3 id="dirk-ginader-82205-layers-of-web-accessibility8221">Dirk Ginader: “5 layers of web accessibility”</h3>

<div class="image-block full">
  <a href="http://www.flickr.com/photos/franksvalli/4803100401/"><img src="http://davidbcalhoun.com/wp-content/uploads/2010/07/owc2-5.jpg" alt="Dirk Ginader" title="Dirk Ginader" width="800" height="533" class="aligncenter size-full wp-image-377" /></a><cite>Dirk Ginader (<a href="http://twitter.com/ginader">@ginader</a>)</cite>
</div>

<p>Dirk is another Yahoo! (we’re everywhere!) whose presentation was also about accessibility.</p>

<p>As web developers, we’re already familiar with three layers of the web:</p>

<p>-HTML, responsible for content<br />
-CSS, responsible for presentation<br />
-JavaScript, responsible for interaction</p>

<p>Dirk introduced another two levels:</p>

<p>-CSS for JavaScript: special styling for when the full-featured JavaScript is available (this can be used by having JS add a “js” class to the document, and therefore writing CSS rules with “.js” in the front)<br />
-WAI-ARIA: special HTML attributes to help define roles, landmarks, allow the developer to give instructions directly through the screen reader, etc.</p>

<p>Also a few more points:<br />
-use the JavaScript focus() method for events (alerts that are injected at the top of the document and are otherwise ignored by the screen reader, windows that open and close, etc.)<br />
-:hover CSS pseudoclass is for the mouse only.. be sure to also use the :focus pseudoclass! (my note: this is also important on mobile, for touch devices!)</p>

<h3 id="summary">Summary</h3>

<p>Overall a great day. The food was pricey but good, and the whole event was free, so I can’t complain! Nice event, I just wish I could’ve seen the other talks in the other tracks!</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2010/friday-links-july-15">
			
				Friday Links: Mobile Performance Studies, the Upcoming Device Element, and More (July 15)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2010-07-16T00:00:00-07:00" pubdate data-updated="true">Jul 16<span>th</span>, 2010</time></div>
	</header>
	<div class="entry-content">
		<h3 id="mobile">Mobile</h3>

<p><a href="http://www.flickr.com/photos/spierisf/4776109875/">Flickr for iPhone 1.2 released</a><br />
<a href="http://techcrunch.com/2010/07/15/firefox-iphone/">Firefox Home For iPhone Approved, Lets You Sync Bookmarks, Open Tabs And More</a><br />
<a href="http://my.opera.com/ODIN/blog/2010/07/15/opera-mobile-10-1-for-s60">Opera Mobile 10.1 for S60</a>: W3C gelocation, border-radius &#038; 2D transforms on S60 platform<br />
<a href="http://www.yuiblog.com/blog/2010/07/12/mobile-browser-cache-limits-revisited/">Mobile Browser Cache Limits, Revisited</a> by Ryan Grove<br />
<a href="http://www.stevesouders.com/blog/2010/07/12/mobile-cache-file-sizes/">Mobile cache file sizes</a> (and other performance tests on mobile devices) by Steve Souders<br />
<a href="http://ipadtest.wordpress.com/2010/07/12/out-of-nowhere-the-ipad-has-a-real-competitor/">Out Of Nowhere, The iPad Has A Real Competitor</a>: the Android-based Pandigital Novel<br />
<a href="http://gigaom.com/2010/07/13/charles-jolley-srpoutcore-strobe/">Ex-Apple Javascript Guru: HTML5 and Native Apps Can Live Together</a></p>

<h3 id="html">HTML</h3>

<p>[[whatwg] The vision behind the <device> element and the ConnectionPeer interface][8]: Hixie (Ian Hickson) explains the future of video conferencing, real-time games, and peer-to-peer file transfer from the browser  
[The id attribute just got more classy in HTML5][9]: probably not very useful, but good to know. Summary: in HTML 4.01 you could use almost any crazy characters for class names (♥, ⌘, ⌥, etc.), and now with HTML5 you can do the same for ids.  
[<mark>][10]: how do you use it semantically?</mark></device></p>

<h3 id="events">Events</h3>

<p>FREE <a href="http://momosv-jul19.eventbrite.com/">MobileMonday Night in the Park – Mobile Life and Demos (San Francisco)</a><br />
$ <a href="http://devnation.us/events/9">DevNation San Francisco (August 14, 2010)</a>: $50 if you get the early bird discount!<br />
<script type="math/tex"></script>$ <a href="http://www.design4mobile.com/">Design For Mobile 2010</a>: “Design For Mobile is the first and only North American mobile user experience conference. The focus is on strategy and tactics for user research, product definition, interaction and other design, and usability testing.” ($1,700 early bird discount)</p>

<h3 id="javascript">JavaScript</h3>

<p><a href="http://www.klauskomenda.com/code/javascript-programming-patterns/">JavaScript Programming Patterns</a>: Klaus Komenda gives a concise explanation of the various coding patterns created over the years. Not a new post, but it’s so good that it’s worth mentioning.<br />
<a href="http://dailyjs.com/">DailyJS: A JavaScript Blog</a><br />
<a href="http://emmett.be/thewebdev/archives/96">Caveats of the JS Module Pattern</a><br />
<a href="http://yayquery.com/">VIDEO: yayQuery Podcast Episode 19</a>: HTML5, Sencha, John Resig, etc.<br />
<a href="http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/">How ECMAScript 5 still does not allow to subclass an array</a></p>

<h3 id="css">CSS</h3>

<p><a href="http://my.opera.com/ODIN/blog/2009/10/12/how-media-queries-allow-you-to-optimize-svg-icons-for-several-sizes">How media queries allow you to optimize SVG icons for several sizes</a><br />
<a href="http://webkit.org/blog/55/high-dpi-web-sites/">High DPI Web Sites</a>: Dave Hyatt explains circa 2006 another way of targeting high-DPI devices (before media queries were around)<br />
<a href="http://css3pie.com/">CSS3 PIE</a>: “PIE makes Internet Explorer 6-8 capable of rendering several of the most useful CSS3 decoration features.”</p>

<h3 id="books">Books</h3>

<p><a href="http://www.amazon.com/Introducing-HTML5-Voices-That-Matter/dp/0321687299">Introducing HTML5 (Voices That Matter)</a> (<a href="http://twitter.com/brucel">Bruce Lawson</a>, <a href="http://twitter.com/REM">Remy Sharp</a>)</p>

<h3 id="etc">Etc</h3>

<p><a href="http://www.youtube.com/watch?v=-BsB0HpS768">VIDEO: Paul Rouget on Mixing the web! (Mozilla Summit 2010)</a>: mixing HTML5, CSS3, WebGL, websockets… etc<br />
<a href="http://5by5.tv/bigwebshow/12">VIDEO: The Big Web Show Episode 12: Web Conferences</a>: Andy McMillan and Eric Meyer<br />
<a href="http://blogs.msdn.com/b/ie/archive/2010/07/14/caching-improvements-in-internet-explorer-9.aspx">Caching Improvements in Internet Explorer 9</a><br />
<a href="http://www.lukew.com/ff/entry.asp?1149">Web App Masters: Designing for Interesting Moments</a>: notes from Bill Scott’s presentation Designing for Interesting Moments<br />
<a href="http://www.couch.io/">CouchDB 1.0 released</a></p>

<p>(thanks to <a href="http://developer.yahoo.net/blog/archives/2010/07/tech_thursday_browsers_javascript_football_and_html5_hunks.html">Chris Heilmann’s Tech Thursday</a> for some of the links)</p>


		
		
	</div>

</article>

<nav id="pagenavi">
    
        <a href="/blog/page/5/" class="prev">Previous</a>
    
    
        <a href="/blog/page/7/" class="next">Next</a>
    
</nav>
</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2014

    David Calhoun

</footer>
	<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script> -->
<!-- <script src="/javascripts/hyphenator.js"></script> -->


<script type="text/javascript">
      var disqus_shortname = 'davidbcalhoun';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script src="/javascripts/main.js"></script>
<!-- <script src="/javascripts/negative-scroll-blur.js"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5530615-3', 'davidbcalhoun.com');
  ga('send', 'pageview');

</script>

</body>
</html>
