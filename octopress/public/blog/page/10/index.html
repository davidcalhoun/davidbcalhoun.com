
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>  | David Calhoun's blog</title>

	<meta name="author" content="David Calhoun">

<meta name="description" content="Introduction One of the things that’s always been confusing to me is that there are multiple ways to declare variables in JavaScript, and some ways &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="David Calhoun's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="/javascripts/html5.js"></script><![endif]-->
	

</head>



<body>
	<header id="header" class="inner"><h1><a href="/">David Calhoun's blog</a></h1>
<span class="tagline"></span>
<!-- <nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav> -->
<!-- <nav id="mobile-nav"> -->
<!-- 	<div class="alignleft menu"> -->
<!-- 		<a class="button">Menu</a> -->
<!-- 		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</div> -->
<!-- 	</div> -->
<!-- </nav> -->


</header>

	<div id="content" class="inner">


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2009/pitfalls-of-declaring-variables-in-javascript">
			
				Pitfalls of Declaring Variables in JavaScript</a>
		</h2>
		<div class="meta date">








  


<time datetime="2009-11-18T00:00:00-08:00" pubdate data-updated="true">Nov 18<span>th</span>, 2009</time></div>
	</header>
	<div class="entry-content">
		<h3 id="introduction">Introduction</h3>

<p>One of the things that’s always been confusing to me is that there are multiple ways to declare variables in JavaScript, and some ways are better than others. For the beginner programmer, just getting to code to work means complete success, but for the intermediate or advanced programmer, this is just the first step. The next step is to clean up the code and make sure everything is written in the best way it could have been written.</p>

<p>Declaring variables seems like such a basic thing that one almost feels insulted reading about it. Yes, this whole post is about declaring variables. But not just this – it’s about declaring variables <em>the right way</em>. This means declaring variables in the scope they were intended to be declared in.  For the most part this means writing variables in the scope of a function, as opposed to the global namespace (in which everything becomes a property of the window object).</p>

<h3 id="global-variables-can-be-declared-in-functions">Global variables can be declared in functions</h3>

<p>When I was starting to learn JavaScript, I read about global and functional scope and <em>wrongly</em> assumed that functions <em>completely</em> protected the variables declared inside.  As it turns out, there’s many ways to create global variables in JavaScript, and none of them throw up red flags or sound off bells and whistles (unfortunately).</p>

<p>Here’s a few ways to create global variables in JavaScript:</p>

<pre name="code" class="JScript">// Creating global variables outside of a function
window.global1 = 1;
global2 = 2;
var global3 = 3;

// Created global variables within a function
function test() {
    global4 = 4;
    window.global5 = 5;
};
test();</pre>

<p>You can confirm this for yourself by checking the values of the variables with alert().</p>

<h3 id="good-practice-always-precede-variables-with-var">Good practice: always precede variables with var</h3>

<p>What I learned was that it was essentially good practice to always write variables preceded by the var keyword.  For variables declared outside of functions this has no effect – they are still global, but for variables within functions this ensures that they’re kept within their functional scope:</p>

<pre name="code" class="JScript">var global = null;
function test() {
    var local = null;
}
test();</pre>

<h3 id="same-name-but-different-variables">Same name, but different variables</h3>

<p>And check this out – confusingly, you can create a global variable, then create a variable with the <em>same name</em> that’s functionally-scoped, yet a completely different variable!</p>

<pre name="code" class="JScript">var number = 0;

function test() {
    var number = 1;
}
test();

alert(number);  // 0</pre>

<p>When you precede a variable with the var keyword, you’re essentially saying you’re creating the variable for the first time.  So when you create “number” inside the function, no error is thrown because the variable is created in the function’s scope.  If you try to create another variable with the name “number” inside the function, you will get an error because it’s already been defined within the scope.</p>

<h3 id="there8217s-no-such-thing-as-magical-protective-parenthesis">There’s no such thing as magical protective parenthesis</h3>

<p>For some reason I was further mistaken into believing that extra parenthesis around an anonymous function magically protected <em>all</em> the variables within:</p>

<pre name="code" class="JScript">(function() {
    global = null;
    var local = null;
})();</pre>

<p>Nope – as you can see, the global variable is still global since it’s not preceded by the var keyword.  However, the local variable is local because it’s within its functional scope and preceded by the var keyword.</p>

<h3 id="shorthand-for-declaring-multiple-functionally-scoped-variables">Shorthand for declaring multiple functionally-scoped variables</h3>

<p>The following code ensures each variable is functionally (locally) scoped, even though only the first variable is preceded by the var keyword:</p>

<pre name="code" class="JScript">// shorthand #1
function test() {
    var local1 = null,
        local2 = null;
}
test();

// shorthand #2
function test2() {
    var local1, local2;  // these are of type 'undefined' but they have functional scope!
}
test2();
</pre>

<h3 id="multiple-variable-declaration-equivalence-gives-different-scope-to-each-variable">Multiple variable declaration equivalence gives different scope to each variable</h3>

<p>Today I learned another way to mistakenly create a global variable.  Trying to be fancy and declare multiple variables to be the same value, I mistakenly created a global variable (again, no bells and whistles went off to warn me, unfortunately):</p>

<pre name="code" class="JScript">function test() {
    var local = global = null;
}
test();</pre>

<p>This sets both variables to “null” using the shortest code possible, but unfortunately only the variable “local” is preceded by the var keyword, so only that variable will be in its proper functional scope. Variable “global”, on the other hand, is… well… global. (thanks to <a href="http://stackoverflow.com/questions/1758576/multiple-left-hand-assignment-with-javascript/1758912#1758912">Crescent Fish</a>)</p>

<p>You learn something new every day…</p>

<h3 id="update-1">Update 1</h3>

<p>If you want to check your code for “accidental global variables” you can use <a href="http://www.jslint.com/">JSLint</a> or you can even use Firebug (click on the Script tab, then click on “New watch expression…”, then type “window”, which will display all the properties of the window object – these are all global variables!). Thanks to Nick for the Firebug tip.</p>

<h3 id="update-2">Update 2</h3>

<p>Just another quick note to remind you that after a variable has been initially declared, the scope will not change. Which is why you can redefine variables, but have them keep their scope:</p>

<pre name="code" class="JScript">function test() {
    var local = null;
    local = 5;    // still keeps its local/functional scope
}
test();</pre>

<p>As you can see above, the variable “local” keeps its local scope, even though it’s redefined to be 5. This is one of the reasons it’s recommended to declare all variables at the start of a function – to make sure the scope gets set correctly.</p>

<p>One final note: var should only be used when declaring a variable for the first time. If you try to use var for the same variable name in the same scope, it will result in an error:</p>

<pre name="code" class="JScript">function test() {
    var local = null;
    var local = 5;    // throws an error!
}
test();</pre>

<h3 id="update-3-graphical-representation">Update 3: Graphical representation</h3>

<div id="attachment_115" style="width: 710px" class="wp-caption alignleft">
  <a href="http://davidbcalhoun.com/wp-content/uploads/2009/11/js-scope.png"><img src="http://davidbcalhoun.com/wp-content/uploads/2009/11/js-scope.png" alt="Scope in JavaScript" title="Scope in JavaScript" width="700" class="size-full wp-image-115" /></a><p class="wp-caption-text">
    Scope in JavaScript
  </p>
</div>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2009/javascript-tidbit-block-scope-with-let">
			
				JavaScript Tidbit: Block Scope With &#8220;let&#8221;</a>
		</h2>
		<div class="meta date">








  


<time datetime="2009-09-15T00:00:00-07:00" pubdate data-updated="true">Sep 15<span>th</span>, 2009</time></div>
	</header>
	<div class="entry-content">
		<p>JavaScript has <strong>functional scope</strong>. Meaning that if you (properly) define variables within functions, those variables remain accessible only inside the function.</p>

<p><strong>Block scope</strong>, on the other hand, defines scope within a block of code, usually defined by braces. JavaScript now has block scope as of version 1.7, which means it’s available in these browsers:</p>

<ul>
  <li>Firefox 2+</li>
</ul>

<p>Block scope is enabled in JavaScript with the use of “let”:</p>

<pre name="code" class="JScript">let(x=100) {
    alert(x);
};</pre>

<p>It also works perfectly well on one line, without the use of braces:</p>

<pre name="code" class="JScript">let(x=100) alert(x);</pre>

<p>Note that we can define global variables with the same name outside the block scope and the variables won’t interfere with each other:</p>

<pre name="code" class="JScript">x = 200;
let(x=100) alert(x);
alert(x);
// result: 100, 200
</pre>

<p>Note that there’s a slight caveat – not only is this not available in any version of IE, but it also requires a special script type declaration in order to work (at least for Firefox): <strong>type=”text/javascript;version=1.7″</strong></p>

<p>References:<br />
<a href="http://en.wikipedia.org/wiki/JavaScript#Versions">JavaScript Versions</a><br />
<a href="http://www.youtube.com/watch?v=0LKDImgRfrg#t=32m2s">Video: Best Practices in Javascript Library Design (John Resig)</a><br />
<a href="https://developer.mozilla.org/en/New_in_JavaScript_1.7">New in JavaScript 1.7</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2009/php-tidbit-dead-simple-singleton">
			
				PHP Tidbit: Dead Simple Singleton</a>
		</h2>
		<div class="meta date">








  


<time datetime="2009-09-14T00:00:00-07:00" pubdate data-updated="true">Sep 14<span>th</span>, 2009</time></div>
	</header>
	<div class="entry-content">
		<pre name="code" class="php">class Singleton {
    private static $instance;
    public static function getInstance() {
        if(!isset(self::$instance)) {
            $c = __CLASS__;
            self::$instance = new $c();
        }
        return self::$instance;
    }
}</pre>

<p>And the explanation…</p>

<pre name="code" class="php">class Singleton {
    private static $instance;               // static variable to hold our 1 instance

    public static function getInstance() {  // function to get the 1 instance
        if(!isset(self::$instance)) {       // this will only run once (and instantiate once)
            $c = __CLASS__;                 // get the class (Singleton)
            self::$instance = new $c();     // instantiate the class and store it in our variable
        }
        return self::$instance;             // return the instance
    }

    public static function myFunction() {   // we can get to this through Singleton::getInstance()-&gt;myFunction()
        // ...
    }
}</pre>

		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2009/javascript-tidbit-shorthand-object-instantiation">
			
				JavaScript Tidbit: Shorthand Object Instantiation</a>
		</h2>
		<div class="meta date">








  


<time datetime="2009-09-14T00:00:00-07:00" pubdate data-updated="true">Sep 14<span>th</span>, 2009</time></div>
	</header>
	<div class="entry-content">
		<p>The skinny: here’s a neat little trick to reduce the amount of code users have to type to instantiate objects:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">jQuery</span>(str, con){
    <span class="keyword">if</span> ( window == <span class="local-variable">this</span> )
        <span class="keyword">return</span> <span class="keyword">new</span> jQuery(str, con);
    <span class="comment">// ...</span>
}

<span class="keyword">new</span> jQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">#foo</span><span class="delimiter">&quot;</span></span>); <span class="comment">// this is now equivalent...</span>
jQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">#foo</span><span class="delimiter">&quot;</span></span>);     <span class="comment">// ...to this!</span>
</pre></td>
</tr></table>
</div>

<p>Explanation: when jQuery(“#foo”) is typed, the function first determines if the context in which it’s being called is the global object (window).  If it is, it returns an instantiation of itself.  When it’s instantiated, the context in which it’s being called is inside its own function, and NOT within the global object (window), thus it bypasses our little instantiation trick and moves on to execute any remaining code in the function.</p>

<p>From John Resig’s <a href="http://www.youtube.com/watch?v=0LKDImgRfrg#t=32m2s">Best Practices in Javascript Library Design</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2009/ie-mobile-6-12-problem-browser-ignores-the-specificity-of-css-display-styles">
			
				IE Mobile 6.12 Problem: Browser Ignores the Specificity of CSS Display Styles</a>
		</h2>
		<div class="meta date">








  


<time datetime="2009-08-31T00:00:00-07:00" pubdate data-updated="true">Aug 31<span>st</span>, 2009</time></div>
	</header>
	<div class="entry-content">
		<p><strong>UPDATE:</strong> I found that the problem is actually that inline-block is completely unsupported in this version of IE Mobile, and is likely also unsupported in IE Mobile 7, which is also based on IE4. This is in contrast to desktop IE6, where inline-block is supported on elements that are natively inline (span, em, etc.).</p>

<p>Just found this today, for what it’s worth.  If you’re unlucky enough to be working with older Windows Mobile phones you have probably realized that the browser is based on IE6, which all the desktop web developers notoriously complain about constantly.</p>

<p>Though the mobile version of IE6 has most of the same issues as its desktop counterpart, IEMobile introduces some new random problems.  And in most cases there’s no handy web resources to help you out, since almost everyone develops for the desktop.</p>

<p>This particular IEMobile quirk is a specificity problem.  We have a parent element styled with display: block and the child element is styled with display: inline-block or display: inline.  We’ve made the child CSS selector more specific so it <em>should</em> override the parent:</p>

<pre name="code" class="css">.parent { display: block; }
.parent .child { display: inline-block; }</pre>

<p>This works on the desktop version of IE6!  But not in IEMobile 6.12, where the child element is still displayed as a block.  The same thing happens when we change the “.parent .child” style to “display: inline;”, but interestingly not when we change it to “display: none;”, where the style is correctly recognized and applied.  Doh!</p>

<p>And FYI: I checked and found that this bug is <em>not</em> occurring on IEMobile 8.12</p>

		
		
	</div>

</article>

<nav id="pagenavi">
    
        <a href="/blog/page/9/" class="prev">Previous</a>
    
    
</nav>
</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2015
<a href="mailto:david.b.calhoun@gmail.com">David Calhoun</a> (<a href="https://twitter.com/franksvalli">@franksvalli</a>) - <a href="https://www.linkedin.com/in/davidcalhoun">LinkedIn</a> - <a href="http://themaingate.net/resume/">Resume</a></footer>
	<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script> -->
<!-- <script src="/javascripts/hyphenator.js"></script> -->


<script type="text/javascript">
      var disqus_shortname = 'davidbcalhoun';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script src="/javascripts/main.js"></script>
<!-- <script src="/javascripts/negative-scroll-blur.js"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5530615-3', 'davidbcalhoun.com');
  ga('send', 'pageview');

</script>

</body>
</html>
