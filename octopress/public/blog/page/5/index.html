
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>  | David Calhoun's blog</title>

	<meta name="author" content="David Calhoun">

<meta name="description" content="(OR “The Post In Which I Conflate Programming and Philosophy” OR “The Programmer’s Existentialist Crisis”) I woke up this morning to read Dmitry A. &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="David Calhoun's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="/javascripts/html5.js"></script><![endif]-->
	

</head>



<body>
	<header id="header" class="inner"><h1><a href="/">David Calhoun's blog</a></h1>
<span class="tagline"></span>
<!-- <nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav> -->
<!-- <nav id="mobile-nav"> -->
<!-- 	<div class="alignleft menu"> -->
<!-- 		<a class="button">Menu</a> -->
<!-- 		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</div> -->
<!-- 	</div> -->
<!-- </nav> -->


</header>

	<div id="content" class="inner">


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/improving-yourself-as-a-programmer-versus-as-a-human-being">
			
				Improving Yourself as a Programmer Versus as a Human Being</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-02-20T00:00:00-08:00" pubdate data-updated="true">Feb 20<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p>(OR “The Post In Which I Conflate Programming and Philosophy” OR “The Programmer’s Existentialist Crisis”)</p>

<p>I woke up this morning to read Dmitry A. Soshnikov’s tweet:<br />
<a href="http://twitter.com/#!/DmitrySoshnikov/status/39356492058607616"><img src="http://davidbcalhoun.com/wp-content/uploads/2011/02/two-programming-languages.png" alt="Have one-two langs in which you are a master and know professionally, and in addition, consider alternative langs. Your experience will grow." width="661" height="318" class="aligncenter size-full wp-image-639" /></a></p>

<p>While this seems like good advice for aspiring programmers, I can’t help but think what this means for those who will buy into this. Us programmers have a keen ability to sit and focus on problems for extended periods of time, usually to the detriment of everything else around us. From the perspective of “real life”, we might as well be sitting in a basement somewhere playing World of Warcraft. Sure, programming is more productive, profitable, and surely not brainless, but at the end of the day we could still only be sitting in a basement somewhere. What I mean to say here is that we’re not actually living our actual lives doing these things.</p>

<p>I realize Dmitry was only talking about learning another programming language for professional life, but for me and so many others, professional life is not easily separated from personal life. We don’t just work during the week during work hours. We can’t just turn off our minds and stop thinking about it when we go home. I end up thinking about programming or web design puzzles in my leisure time and on weekends, largely <em>because I enjoy doing so</em>. But when I see something questioning whether I should be devoting even more of this time to learning another programming language, I think about what I could be doing instead. Put another way, I think about what is missing and neglected in my life, and how those things will remain missing and neglected.</p>

<p>Socrates famously said <a href="http://en.wikiquote.org/wiki/Socrates#Apology">“The unexamined life is not worth living”</a>. He, along with those who followed in his immediate footsteps (famously, Plato and Aristotle) were concerned with how us mere mortals should live our lives, and more particularly how we should lead <em>good</em> lives. The sad fact about (western) philosophy is that it’s turned into a shadow of its former self, now plagued by millennia of self-doubt and failed grandiose systems. But it seems the original Socratic intention of finding how to lead a <em>good</em> life is still an admirable goal, even if we disagree on how exactly to achieve it.</p>

<p>Socrates also had a bit to say about those seeking to be experts in their field, and he couldn’t resist getting in a jab at his wife in the process:</p>

<blockquote>
  <p>It is the example of the rider who wishes to become an expert horseman: “None of your soft-mouthed, docile animals for me,” he says; “the horse for me to own must show some spirit” in the belief, no doubt, if he can manage such an animal, it will be easy enough to deal with every other horse besides. And that is just my case. I wish to deal with human beings, to associate with man in general; hence my choice of wife. I know full well, if I can tolerate her spirit, I can with ease attach myself to every human being else.</p>
</blockquote>

<p>Yes, Socrates essentially just compared his wife with a horse. A wild horse, to be exact.</p>

<p>I’m unsure if this translates well into learning programming languages. Does this mean we should learn the worst languages first, so that the rest of the languages we learn will be comparably easy? I hope not, that seems like quite a lot of wasted time. But I certainly agree that <em>the first languages we learn shouldn’t be the easiest</em>. This might only make us frustrated in the long run. So perhaps we can learn something from Socrates’s quote after all, if taken with a grain of salt.</p>

<p>So should we still strive to become experts in our field? I believe that’s an admirable and acceptable goal, but it shouldn’t be our main goal. We should first be concerned with leading good lives. I myself have a LONG way to go on this point, believe me.</p>

<p>I’ll surely learn another programming language, but not for its own sake, unless my life is in reasonably good order.</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/checking-for-undefined-null-and-empty-variables-in-javascript">
			
				Checking for Undefined, Null, and Empty Variables in JavaScript</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-02-11T00:00:00-08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p>In general it’s a good practice to check for the existence of something before blindly using it by faith and hoping it works. There are various times during the execution of scripts when a variable may not be defined, it may be null, or it might be an empty string. These are three things that are easily conflated. A good way to look at this is thinking of these as having increasing levels of existence (getting a bit philosophical here for a moment…):</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
</pre></td>
  <td class="code"><pre>foo0;             <span class="comment">// existence level 0 (creates the error &quot;not defined&quot;)</span>
<span class="keyword">var</span> foo1;         <span class="comment">// existence level 1 (&quot;undefined&quot; - variable declared but not defined/initialized)</span>
<span class="keyword">var</span> foo2 = <span class="predefined-constant">null</span>;  <span class="comment">// existence level 2 (variable initialized, but isn't an Object, Number, String, etc)</span>
<span class="keyword">var</span> foo3 = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;    <span class="comment">// existence level 3 (variable initialized to an empty String)</span>
<span class="keyword">var</span> foo4 = <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>; <span class="comment">// existence level 4 (variable initialized to String &quot;foo&quot;)</span>
</pre></td>
</tr></table>
</div>

<p>Generally it would be handy if we had some way to filter out everything but the very last line. We simply want to check for these cases without the script entirely blowing up, as it does with the first line:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
</pre></td>
  <td class="code"><pre>foo;  <span class="comment">// ReferenceError: foo is not defined</span>
</pre></td>
</tr></table>
</div>

<p>We’re not particularly doing anything useful with foo here, but notice that the script fails out anyway. At this point any code that follows will not be executed. Your first instinct might be “Oh! I know how to contain these errors! We’ll use a try-catch!”:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
</pre></td>
  <td class="code"><pre><span class="keyword">try</span> {
  foo;
} <span class="keyword">catch</span>(e) {
  e.message;  <span class="comment">// &quot;foo is not defined&quot;</span>
}
</pre></td>
</tr></table>
</div>

<p>The script still fails, but not critically, so your script continues to execute. But this turns out to aversely affect performance. The basic lesson here is that try-catch can be useful in some situations, but shouldn’t be used where alternatives are available.</p>

<h3 id="typeof-foo">typeof foo</h3>

<p>JavaScript has quite a useful remedy for this:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
</pre></td>
  <td class="code"><pre><span class="keyword">typeof</span> foo; <span class="comment">// &quot;undefined&quot;</span>
</pre></td>
</tr></table>
</div>

<p>Unlike everything else in JavaScript, typeof will deal with whatever you throw at it, including undefined variables. So you can use it as a simple check before using a variable that might not exist:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(<span class="keyword">typeof</span> foo !== <span class="string"><span class="delimiter">&quot;</span><span class="content">undefined</span><span class="delimiter">&quot;</span></span>) {
  <span class="comment">// do something with foo</span>
}
</pre></td>
</tr></table>
</div>

<p>Note that this is easy to confuse with the <code>undefined</code> keyword, which in this case doesn’t help us one bit, as it gives us a fatal error:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(foo !== <span class="predefined-constant">undefined</span>) {  <span class="comment">// ReferenceError: foo is not defined</span>

}
</pre></td>
</tr></table>
</div>

<p>This filters out our first two cases, since they both evaluate to “undefined”:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
</pre></td>
  <td class="code"><pre><span class="keyword">typeof</span> foo; <span class="comment">// &quot;undefined&quot;</span>

<span class="keyword">var</span> bar;
<span class="keyword">typeof</span> bar; <span class="comment">// &quot;undefined&quot;</span>
</pre></td>
</tr></table>
</div>

<p>But this turns out not to work well for our other conditions, which evaluate differently:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre><span class="keyword">typeof</span> <span class="predefined-constant">null</span>;  <span class="comment">// &quot;object&quot; (what?!)</span>
<span class="keyword">typeof</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;    <span class="comment">// &quot;string&quot;</span>
</pre></td>
</tr></table>
</div>

<p>So we need to add other “if” conditions to check.. but there turns out to be a better way!</p>

<h3 id="exploiting-loose-typing">Exploiting loose typing</h3>

<p>JavaScript is a loosely typed language, which means that it will “automagically” cast variables into other types when necessary (i.e. when adding a Number to a String), sometimes resulting in the unexpected. For instance, whenever we use the “if” statement, the expected input is a Boolean true/false value. If JavaScript gets anything other than a Boolean, such as a String or a Number, instead of blowing up completely (as in strictly typed languages such as C), it’ll cast the variable into a Boolean for you.</p>

<p>“How handy!” you might think. Except in the following unexpected cases:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>) {
  <span class="comment">// this will run because &quot;0&quot; is true</span>
}

<span class="keyword">if</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>) {
  <span class="comment">// this will run because &quot;false&quot; is true</span>
}
</pre></td>
</tr></table>
</div>

<p>To see what JavaScript will cast a value to without having to use an <code>if</code> statement, we could create a new Boolean value with the following:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre>Boolean(<span class="integer">0</span>);    <span class="comment">// false</span>
Boolean(<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>);  <span class="comment">// true</span>
</pre></td>
</tr></table>
</div>

<p>Or we can use the less intuitive but quick way of using double exclamation marks (this will probably award you cleverness points in someone’s book.. hopefully those points actually matter):</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre>!!<span class="integer">0</span>;    <span class="comment">// false</span>
!!<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>;  <span class="comment">// true</span>
</pre></td>
</tr></table>
</div>

<p>This works because !foo converts foo to a Boolean but negates its original value, turning it on its head. !!foo converts foo to a Boolean and flips it back to its expected value, which is the same value that’s evaluated by our <code>if</code> statement.</p>

<p>Using this ALMOST gives us the answer we’re looking for:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
</pre></td>
  <td class="code"><pre>!!foo0; <span class="comment">// ReferenceError: foo0 is not defined</span>

<span class="keyword">var</span> foo1;
!!foo1; <span class="comment">// false</span>

<span class="keyword">var</span> foo2 = <span class="predefined-constant">null</span>;
!!foo2; <span class="comment">// false (same as !!null)</span>

<span class="keyword">var</span> foo3 = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
!!foo3; <span class="comment">// false (same as !!&quot;&quot;)</span>

<span class="keyword">var</span> foo4 = <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>;
!!foot4; <span class="comment">// true (same as !!&quot;bar&quot;)</span>
</pre></td>
</tr></table>
</div>

<p>Excluding the first example, now we can test for uninitialized variables (foo1), null variables (foo2), and empty strings (foo3) all with just an <code>if</code> statement:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(foo1) {
  <span class="comment">// do something with foo1</span>
}

<span class="keyword">if</span>(foo2) {
  <span class="comment">// do something with foo2</span>
}

<span class="keyword">if</span>(foo3) {
  <span class="comment">// do something with foo3</span>
}
</pre></td>
</tr></table>
</div>

<p>Dang… so close! But we can’t yet test the first case without an error:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(foo0) {  <span class="comment">// ReferenceError: foo0 is not defined</span>

}
</pre></td>
</tr></table>
</div>

<h3 id="foo-versus-windowfoo-and-thisfoo">foo versus window.foo and this.foo</h3>

<p>The secret to our solution lies in how JavaScript handles undefined variables versus undefined properties. Here’s a quick reminder on the difference between the two:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
</pre></td>
  <td class="code"><pre><span class="comment">// variable foo</span>
<span class="keyword">var</span> foo;

<span class="comment">// property bar (and object variable foo)</span>
<span class="keyword">var</span> foo = {};  <span class="comment">// create an empty object to add bar too</span>
foo.bar = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
</pre></td>
</tr></table>
</div>

<p>The difference between these makes all the difference whether a fatal error occurs:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
</pre></td>
  <td class="code"><pre>foo;  <span class="comment">// ReferenceError: foo is not defined</span>

<span class="keyword">var</span> foo = {};
foo.bar;  <span class="comment">// undefined</span>
foo.blah; <span class="comment">// undefined</span>
</pre></td>
</tr></table>
</div>

<p>We can randomly invent and check any property of <code>foo</code> we want, and the code will keep chugging along:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> foo = {};
foo.something = <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>;

<span class="keyword">if</span>(foo.bar) { <span class="comment">// undefined, interpreted as false (same as !!foo.bar)</span>
  <span class="comment">// never runs</span>
}

<span class="keyword">if</span>(foo.something) {
  foo.something;  <span class="comment">// &quot;hello&quot;</span>
}
</pre></td>
</tr></table>
</div>

<p>Now comes the magic. If you know anything about JavaScript running in the browser, you know that all global variables are part of the <code>window</code> object. This means <code>foo</code> and <code>window.foo</code> are equivalent:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> foo;

foo === window.foo;  <span class="comment">// true</span>

<span class="comment">// &quot;this&quot; is another bag of worms, but note this anyway</span>
<span class="local-variable">this</span>.foo === window.foo;
</pre></td>
</tr></table>
</div>

<p>So technically our variable foo is a <em>property</em> of the window object. So we should be able to check for any arbitrary variable in the window scope now!</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
</pre></td>
  <td class="code"><pre>window.foo;  <span class="comment">// undefined (not a fatal error!)</span>

<span class="comment">// even though we're checking for the same thing, we get a fatal error…</span>
foo;  <span class="comment">// ReferenceError: foo is not defined</span>
</pre></td>
</tr></table>
</div>

<h3 id="practical-uses">Practical uses</h3>

<p>Now as long as we have a global entry point for our code, we can write our code in such a way that it won’t ever give us a fatal error if our variables aren’t yet defined:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span>(window.foo &amp;&amp; foo.bar) {
  foo.bar();
}
</pre></td>
</tr></table>
</div>

<p>Of course nothing happens, because we haven’t defined foo. But why doesn’t foo.bar give us a fatal error? Because the first test, <code>window.foo</code> failed out. It would be useless processing for the JavaScript engine to also evaluate the second statement, because the end result will still be the same (false &#038;&#038; true results in false, false &#038;&#038; false results in false). So it doesn’t get so far as <code>foo.bar</code>.</p>

<p>And now the code will work properly when we hook up our code to our <code>foo</code> global namespace:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> foo = {
  <span class="function">bar</span>: <span class="keyword">function</span>() {
    alert(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>);
  }
}

<span class="keyword">if</span>(window.foo &amp;&amp; foo.bar) {
  foo.bar();  <span class="comment">// &quot;hello world&quot;</span>
}
</pre></td>
</tr></table>
</div>

<h3 id="shorthand">Shorthand</h3>

<p>It’s becoming common to see an abbreviation for the above code. Check out the following two methods, which accomplish the same thing:</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
</pre></td>
  <td class="code"><pre><span class="comment">// Method 1</span>
<span class="keyword">if</span>(window.foo &amp;&amp; foo.bar) {
  foo.bar();  <span class="comment">// &quot;hello world&quot;</span>
}

<span class="comment">// Method 2</span>
window.foo &amp;&amp; foo.bar &amp;&amp; (foo.bar());
</pre></td>
</tr></table>
</div>

<p>Don’t get too scared.. these blocks of code are equivalent. Method 2 is shorter, but it simply goes something like this: if window.foo isn’t set, stop evaluating this line (just as above in the <code>if</code> statement). Otherwise, if foo.bar exists then execute the code in parentheses, which gives us an alert (“hello world”);</p>

<p>Just a word of caution about using Method 2: it’s obviously less clear what’s going on here. Your own cleverness might actually result in unnecessary confusion, especially of other people work in the same code base and they’re at different levels of understanding. In these cases we should first strive to be clear, and then only clever if it’s not at the expense of being clear.</p>

<p>It’s also likely that a code minifier would take care of this cleverness for us at build time, giving us the best of both worlds.</p>

		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/a-peek-into-googles-jules-verne-tribute-february-8-2011">
			
				A Peek Into Google&#8217;s Jules Verne Tribute (February 8, 2011)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-02-07T00:00:00-08:00" pubdate data-updated="true">Feb 7<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p><a href="http://www.youtube.com/watch?v=CW2IXHBPOIo"><img src="http://davidbcalhoun.com/wp-content/uploads/2011/02/google-doodle-jules-verne.png" alt="" title="Google Doodle: Jules Verne tribute" width="938" height="346" class="aligncenter size-full wp-image-626" /></a></p>

<p>This is just a fun little <a href="http://www.youtube.com/watch?v=CW2IXHBPOIo">video demo</a> into the inner workings of today’s Google Doodle. Nothing you can’t do yourself with Firebug or Web Inspector (built into WebKit browsers such as Safari and Chrome). But I liked this doodle so much, I wanted to talk about it!</p>

<p>Disclaimer: I know the difference between HTML5 and CSS3, but I’m not much one for pedantic nomenclature (however, I am apparently supportive of pedantic words like nomenclature). For the purposes of this video, webkit transforms and transitions are part of HTML5.</p>

<p>EDIT: Apparently I missed that the doodle has accelerometer support for devices that support it! Confirmed that it works on my MacBook Pro in Chrome.</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/javascript-sunspider-benchmark-ios-4-3-vs-ios-4-0">
			
				JavaScript SunSpider Benchmark: iOS 4.3 vs iOS 4.0</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-22T00:00:00-08:00" pubdate data-updated="true">Jan 22<span>nd</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<h3 id="result-table-sunspider-091">Result table (SunSpider 0.9.1)</h3>

<table>
  <tr>
    <td>
      Test
    </td>
    
    <td>
      iOS 4 (3GS)
    </td>
    
    <td>
      iOS 4.3 beta 2 (3GS)
    </td>
    
    <td>
      % change
    </td>
  </tr>
  
  <tr>
    <td>
      Total
    </td>
    
    <td>
      13787ms
    </td>
    
    <td class="positive">
      5357ms
    </td>
    
    <td class="positive">
      -61.1%
    </td>
  </tr>
  
  <tr>
    <td>
      3D
    </td>
    
    <td>
      1917ms
    </td>
    
    <td class="positive">
      737ms
    </td>
    
    <td class="positive">
      -61.6%
    </td>
  </tr>
  
  <tr>
    <td>
      Access
    </td>
    
    <td>
      1893ms
    </td>
    
    <td class="positive">
      617ms
    </td>
    
    <td class="positive">
      -67.4%
    </td>
  </tr>
  
  <tr>
    <td>
      Bitops
    </td>
    
    <td>
      1239ms
    </td>
    
    <td class="positive">
      289ms
    </td>
    
    <td class="positive">
      -76.7%
    </td>
  </tr>
  
  <tr>
    <td>
      Controlflow
    </td>
    
    <td>
      221ms
    </td>
    
    <td class="positive">
      35ms
    </td>
    
    <td class="positive">
      -84.2%
    </td>
  </tr>
  
  <tr>
    <td>
      Crypto
    </td>
    
    <td>
      850ms
    </td>
    
    <td class="positive">
      308ms
    </td>
    
    <td class="positive">
      -63.8%
    </td>
  </tr>
  
  <tr>
    <td>
      Date
    </td>
    
    <td>
      1065ms
    </td>
    
    <td class="positive">
      706ms
    </td>
    
    <td class="positive">
      -33.7%
    </td>
  </tr>
  
  <tr>
    <td>
      Math
    </td>
    
    <td>
      1511ms
    </td>
    
    <td class="positive">
      606ms
    </td>
    
    <td class="positive">
      -59.9%
    </td>
  </tr>
  
  <tr>
    <td>
      Regexp
    </td>
    
    <td>
      1916ms
    </td>
    
    <td class="positive">
      153ms
    </td>
    
    <td class="positive">
      -92.0%
    </td>
  </tr>
  
  <tr>
    <td>
      String
    </td>
    
    <td>
      3175ms
    </td>
    
    <td class="positive">
      1907ms
    </td>
    
    <td class="positive">
      -39.9%
    </td>
  </tr>
</table>

<h3 id="raw-results-ios-43-beta-2-running-on-my-iphone-3gs">Raw results (iOS 4.3 beta 2 running on my iPhone 3GS)</h3>

<pre>============================================
RESULTS (means and 95% confidence intervals)
--------------------------------------------
Total:                  5357.3ms +/- 2.3%
--------------------------------------------

  3d:                    736.9ms +/- 7.5%
    cube:                260.1ms +/- 3.5%
    morph:               206.0ms +/- 23.2%
    raytrace:            270.8ms +/- 4.4%

  access:                617.4ms +/- 4.1%
    binary-trees:        118.8ms +/- 4.7%
    fannkuch:            180.4ms +/- 0.7%
    nbody:               222.0ms +/- 11.7%
    nsieve:               96.2ms +/- 0.8%

  bitops:                288.7ms +/- 9.6%
    3bit-bits-in-byte:    38.0ms +/- 4.3%
    bits-in-byte:         70.5ms +/- 39.0%
    bitwise-and:          85.1ms +/- 1.9%
    nsieve-bits:          95.1ms +/- 2.1%

  controlflow:            34.7ms +/- 3.2%
    recursive:            34.7ms +/- 3.2%

  crypto:                308.3ms +/- 1.1%
    aes:                 175.2ms +/- 0.5%
    md5:                  79.3ms +/- 3.9%
    sha1:                 53.8ms +/- 0.8%

  date:                  706.2ms +/- 5.5%
    format-tofte:        341.3ms +/- 11.0%
    format-xparb:        364.9ms +/- 1.1%

  math:                  605.9ms +/- 1.1%
    cordic:              224.5ms +/- 1.0%
    partial-sums:        263.4ms +/- 2.3%
    spectral-norm:       118.0ms +/- 1.2%

  regexp:                152.5ms +/- 5.5%
    dna:                 152.5ms +/- 5.5%

  string:               1906.7ms +/- 0.7%
    base64:              247.9ms +/- 2.4%
    fasta:               268.5ms +/- 0.6%
    tagcloud:            370.4ms +/- 3.0%
    unpack-code:         676.2ms +/- 0.3%
    validate-input:      343.7ms +/- 1.4%
</pre>

<p><a href="http://davidbcalhoun.com/wp-content/uploads/2010/iOS-4-GM.html">Raw results for iOS 4.0</a></p>

<h3 id="related">Related</h3>

<p><a href="http://davidbcalhoun.com/2010/blackberry-torch-sunspider-results-javascript-benchmark">BlackBerry Torch SunSpider results (JavaScript benchmark)</a><br />
<a href="http://davidbcalhoun.com/2010/iphone-4-sunspider-test-results">iPhone 4 SunSpider test results (22% faster than iPhone 3GS)</a><br />
<a href="http://davidbcalhoun.com/2010/sunspider-ios-3-1-3-versus-ios-4-gm">JavaScript SunSpider test: iOS 3.1.3 versus iOS 4 GM</a><br />
<a href="http://davidbcalhoun.com/2010/javascript-sunspider-htc-evo-versus-htc-incredible-versus-nexus-one">JavaScript SunSpider: HTC Evo versus HTC Incredible versus Nexus One</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/notes-mobile-web-design-cameron-moll-200">
			
				Notes: Mobile Web Design (Cameron Moll, 2007)</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-21T00:00:00-08:00" pubdate data-updated="true">Jan 21<span>st</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<h3 id="what8217s-this">What’s this?</h3>

<p>These are some notes I collect as I read through Cameron Moll’s <a href="http://www.amazon.com/Mobile-Web-Design-Cameron-Moll/dp/0615185916">Mobile Web Design</a>.</p>

<h3 id="introduction">Introduction</h3>

<ol>
  <li>Further info:</li>
</ol>

<p>Designing the Mobile User Experience (Barbara Ballard)<br />
dotMobi Web Developer’s Guide (dev.mobi)<br />
Global Authoring Practices for the Mobile Web (Luca Passani) (passani.it/gap)<br />
Constant Touch: A Global History of the Mobile Web (Jon Agar)<br />
Personal, Portable, Pedestrian: Mobile Phones in Japanese Life (Mizuko Ito)<br />
Mobile Interaction Design (Matt Jones)</p>

<ol>
  <li>iPhone released just before publication</li>
</ol>

<h3 id="mobile-web-fundamentals">Mobile Web Fundamentals</h3>

<ol>
  <li>
    <p><a href="http://communities-dominate.blogs.com/brands/2007/01/putting_27_bill.html">Putting 2.7 Billion in Context: Mobile Phone Users</a></p>
  </li>
  <li>
    <p>Phone is smaller. Different input methods. Searching for specific data (directions or a phone number) rather than a truckload of data available via the desktop. One handed interaction.</p>
  </li>
  <li>
    <p>Limitations: small screen size, difficulty of data input, user agent inconsistency</p>
  </li>
</ol>

<p>Opportunities: location-specific data, on-the-go-messaging, voice communication.</p>

<ol>
  <li>
    <p>Weather Channel – greater reach on mobile web compared to desktop (<a href="http://www.comscore.com/Press_Events/Press_Releases/2007/05/Mobile_Web_Usage_Grows_in_UK">source</a>)</p>
  </li>
  <li>
    <p>Rollable display – Polymer Vision Readius (<a href="http://www.youtube.com/watch?v=uQMBzXaCmqY">video</a>)</p>
  </li>
</ol>

<p>Many devices and user agents, making testing expensive and impractical. Emulators and testing on multiple devices will lead to successful deployment.</p>

<ol>
  <li>Opera Mini – far better UI than most native browsers</li>
</ol>

<p>Mostly must be installed manually, except for T-Mobile shipping hundreds of thousands with it pre-installed</p>

<ol>
  <li>
    <p>“…the mobile web experience is often a small screen, intermittent, one-handed experience”</p>
  </li>
  <li>
    <p>understanding of target audience, their usage and what they want, and the contextual relevance (phone numbers, etc.) of data</p>
  </li>
  <li>
    <p>Initiate a phone call: wtai scheme for WML, tel scheme for HTML.</p>
  </li>
</ol>

<p>Some browsers (Opera Mini, Safari Mobile) automatically convert links to phone numbers</p>

<p>WML scheme to add a number to the address book: wtai://wp/ap;+5555555;Amy%20Miller</p>

<ol>
  <li>
    <p>carrier myopia: devs thinking the only way to reach the audience is by landing on the carrier deck. Mobile User Experience Conference (MEX) 2007: “Tearing down the walled garden will enhance the mobile content experience and release value for the industry. The objective should be a free market for content and applications, based on open standards and accessible to all. We think the current fragmentation of formats and channels to market is holding back growth.”</p>
  </li>
  <li>
    <p>“cell phone” is an outdated term. Use “mobile” or “device”.</p>
  </li>
  <li>
    <p>Japanese market: “keitai” (=”something you carry with you”)</p>
  </li>
</ol>

<h3 id="four-methods-revisited">Four Methods, Revisited</h3>

<ol>
  <li>
    <p><a href="http://www.cameronmoll.com/archives/000398.html">Mobile Web Design ~ The Series</a> (Cameron Moll, 2005)</p>
  </li>
  <li>
    <p>Method 1: Do nothing. If the markup is meaningful and standards-based, the better mobile browsers can adapt.</p>
  </li>
  <li>
    <p>Good browsers such as the iPhone’s allow the viewing of the full site (with zooming).</p>
  </li>
  <li>
    <p>Advantages: mobile browsers shoulder the burden of reformatting content, no additional effort needed, users have same content and possibly the same experience as on a PC</p>
  </li>
</ol>

<p>Disadvantages: doesn’t address contextual relevance or exploit device capabilities, users with zoom-enabled devices are a small market share</p>

<ol>
  <li>Method 2: Reduce images and styling</li>
</ol>

<p>-presentation styling and images reduced on the fly</p>

<p>mowser.com (Russell Beattie, formerly Yahoo! Mobile)<br />
skweezer.net – an older service dating back to 2001</p>

<p>2-minute mobile mod: <a href="http://www.mikeindustries.com/blog/archive/2005/07/make-your-site-mobile-friendly">http://www.mikeindustries.com/blog/archive/2005/07/make-your-site-mobile-friendly</a></p>

<ol>
  <li>Advantages: relies on implied hierarchy in HTML markup, viewable by a variety of devices, faster download, many browsers override CSS anyway, so why bother?</li>
</ol>

<p>Disadvantages: ignores contextual relevance of mobility, file size may still be excessive</p>

<p>Method 3: Use Handheld Style Sheets</p>

<ol>
  <li>
    <p>media=”handheld” style sheet</p>
  </li>
  <li>
    <p>Not widely supported.</p>
  </li>
</ol>

<p>Advantages: handheld style sheet is built into CSS, at most one extra style sheet, one web address<br />
Disadvantages: ignores contextual relevance of mobility, media=”handheld” support is inconsistent and nearly unreliable</p>

<p>Method 4: Create Mobile-Optimized Content</p>

<ol>
  <li>
    <p>Kayak.com/moby</p>
  </li>
  <li>
    <p>Advantages: contextually relevant (addresses first how the content is consumed, and presentation secondly), pages are leaner</p>
  </li>
</ol>

<p>Disadvantages: denies access to content by making assumptions about the user and device, two sets of files, alternate web addresses</p>

<ol>
  <li>Author’s opinion: doing nothing and mobile-optimized content are the two viable approaches</li>
</ol>

<h3 id="xhtmlcss-development">XHTML/CSS Development</h3>

<ol>
  <li>
    <p>WML deck and card metaphor. Decline giving way to XHTML. WAP protocol, WML language.</p>
  </li>
  <li>
    <p>With WAP 2.0, XHTML-MP is the preferred markup language</p>
  </li>
  <li>
    <p><a href="http://www.cameronmoll.com/mobile/mkp">Markup Test Pages</a>, <a href="http://www.cameronmoll.com/archives/000577.html">Mobile Web Design: Tips &#038; Techniques (2005)</a></p>
  </li>
  <li>
    <p>No need to define new standards just for the web. Same regardless of device: “The underlying standards for the greater web, regardless of device, person, or place, are the same: semantic markup, separation of structure and presentation, accessibility, and so on.”</p>
  </li>
</ol>

<p><a href="http://www.w3.org/TR/mobile-bp/">W3C Mobile Web Best Practices 1.0</a></p>

<p><a href="http://passani.it/gap">Global Authoring Practices for the Mobile Web (Luca Passani)</a></p>

<ol>
  <li>XHTML-MP template</li>
</ol>

<pre name="code" class="HTML">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;title&gt;Site Title&lt;/title&gt;
  &lt;link rel="stylesheet" type="text/css" href="mobile.css"/&gt;
  &lt;meta http-equiv="Cache-Control" content="max-age=600" /&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Page Heading&lt;/h1&gt;
  &lt;p&gt;Content&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<ol>
  <li>
    <p><a href="http://www.developershome.com/wap/xhtmlmp">DeveloperHome.com’s XHTML-MP Tutorial</a></p>
  </li>
  <li>
    <p><a href="http://htmllint.itc.keio.ac.jp/htmllink/tagslist.cgi?HTMLVersion=XHTML-MP">XHTML-MP Tags List</a></p>
  </li>
</ol>

<p>Good case examples:<br />
<a href="http://flickr.com/mob">Flickr Mobile</a><br />
<a href="http://mobile.fandango.com">Fandango Mobile</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/implementing-iphone-slider-unlock-with-input-type-range">
			
				Implementing iPhone&#8217;s Slider Unlock With Input Type=&#8221;range&#8221;</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-16T00:00:00-08:00" pubdate data-updated="true">Jan 16<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p>(check out the live <a href="http://davidbcalhoun.com/a/iphone-slider.html">demo</a>)</p>

<h3 id="introduction">Introduction</h3>

<p>After reading <a href="http://glazkov.com/2011/01/14/what-the-heck-is-shadow-dom/">“What the Heck is Shadow DOM?”</a> I was inspired to see how far I could style the <input type="range" /> element. Pretty far, as it turns out!</p>

<p>My goal was to change the input’s default appearance:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range.png" alt="The default appearance for input type=range" title="The default appearance for input type=range" width="144" height="25" class="aligncenter size-full wp-image-567" /></p>

<p>To the visual appearance of the iPhone’s unlock slider:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-native.png" alt="The iPhone's unlock slider" title="The iPhone's unlock slider" width="300" height="69" class="aligncenter size-full wp-image-566" /></p>

<p>As far as I can tell, only WebKit-based browsers and Opera have implemented input type=”range”. Mobile Safari hasn’t yet implemented it as of iOS 4.2 and Android also hasn’t fully implemented it as of Android 2.3 (although curiously the elements are styleable but not yet interactive). Surprisingly, the only mobile OS to implement this input type seems to be BlackBerry OS 6.</p>

<p>However, the focus here will be to get this working on just Chrome and WebKit. This will make it a bit easier to do this proof of concept. So we’ll be using lots of “-webkit” vendor prefixed CSS.</p>

<h3 id="what-we-have-to-work-with">What we have to work with</h3>

<p>Of course we have our simple range input:</p>

<pre name="code" class="html">&lt;input type="range"&gt;
</pre>

<p>Which looks like this:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range.png" alt="The default appearance for input type=range" title="The default appearance for input type=range" width="144" height="25" class="aligncenter size-full wp-image-567" /></p>

<p>We can target the input itself with a CSS attribute selector:</p>

<pre name="code" class="CSS">input[type='range'] {}
</pre>

<p>And if we want, we can transform it into a vertical slider by changing the “-webkit-appearance” property:</p>

<pre name="code" class="CSS">input[type='range'] {
    -webkit-appearance: slider-vertical;
}
</pre>

<p>Which looks like this:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-vertical.png" alt="Input range in a vertical orientation" title="Input range in a vertical orientation" width="25" height="119" class="aligncenter size-full wp-image-579" /></p>

<p>If we want to style it as if it was any other element, there’s a slight catch, as we first have to set “-webkit-appearance” to “none” and then add our customizations (this appears to mean that we can’t actually style vertical sliders…). Here we’ll set the background color as a simple demo:</p>

<pre name="code" class="CSS">input[type='range'] {
    -webkit-appearance: none;
    background-color: gray;
}
</pre>

<p>This outputs the following:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-gray-background.png" alt="Input range with a gray background" title="Input range with a gray background" width="129" height="15" class="aligncenter size-full wp-image-577" /></p>

<p>Most interestingly, we can target and style the slider button itself with CSS, although we can’t get access to it with JavaScript (for the time being anyhow). Here we’ll style it a slightly darker shade of gray:</p>

<pre name="code" class="CSS">input[type='range'] {
    -webkit-appearance: none;
    background-color: gray;
}

input[type='range']::-webkit-slider-thumb {
    -webkit-appearance: none;
    background-color: #444;
    width: 15px;
    height: 20px;
}
</pre>

<p>Which results in this:<br />
<img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-styled.png" alt="Input range with a gray background and a slightly darker slider control" title="Input range with a gray background and a slightly darker slider control" width="129" height="20" class="aligncenter size-full wp-image-583" /></p>

<p>Now all the pieces are in place to fully style the input!</p>

<h3 id="styling-the-background">Styling the background</h3>

<p>This part’s no big deal. We just want to set up the width/height, slap on some handy rounded corners, and add a very slight background gradient:</p>

<pre name="code" class="CSS">input[type='range'] {
    -webkit-appearance: none;
    width: 280px;
    height: 46px;
    padding: 3px;
    -webkit-border-radius: 15px;
    border-radius: 15px;
    border: 1px solid #525252;
    background-image: -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #000000),
        color-stop(1, #222222)
    );
}
</pre>

<p>Now we have the backdrop in place:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-background.png" alt="iPhone slider background" title="iPhone slider background" width="288" height="54" class="aligncenter size-full wp-image-585" /></p>

<h3 id="styling-the-button">Styling the button</h3>

<p>To get the button, we’ll add some width/height and rounded corners. Here we’ll also need a more complicated background gradient as well as an arrow icon. Your first instinct might be to add more markup to hook the arrow icon to, but remember that this is impossible. We’re working in the “shadow DOM” of elements created and maintained by the browser itself. We can style the existing elements but we can’t create any new ones.</p>

<p>So what do we do? Take advantage of multiple backgrounds! We can specify the background as both the arrow image and the gradient we need. In this case we’ll also base64 encode the small image to avoid an extra HTTP request.</p>

<p>The CSS for the button looks like this:</p>

<pre name="code" class="CSS">input[type='range']::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 68px;
    height: 44px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAYCAYAAAB0kZQKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASJJREFUeNpi7OnpYaAC0AXiF0D8mhzNTAzUASBHnAdim4F0BAhIA/EBIC4aSEeAADMQ9wLxRiDmHyhHwIAfNHqMiXZEcXExGJMCiNCjCMTHgDiTkFmM////p4rXe3t78Rm0DIjTgfgLNkkWoGZQij7MQFsQBY2aICC+Rq80gQ2oA/EZIE4YSEeAACcQzwfimVD2gDgCBtKgiVZlIB0BAgbQbBwykI5A5I4BtPsaNLfcHKiQWADEJiAHDERIfAfiLKgjBiQ67kCD/zK2NAFqjMyi0AJQVnPCI78GiBNxFttQF6ZToVjG5ohfoLoOiKcMVO54BA3+swPVntgKxIbEOIAWjvgLxJVA7APE7waisHoKxBFAfGSgSszL0MLnBTmaAQIMAKg/OsrT7JG8AAAAAElFTkSuQmCC'),
    -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #fefefe),
        color-stop(0.49, #dddddd),
        color-stop(0.51, #d1d1d1),
        color-stop(1, #a1a1a1)
    );
    background-repeat: no-repeat;
    background-position: 50%;
}
</pre>

<p>Which outputs this:<br />
<img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-button.png" alt="" title="iPhone slider button styled" width="288" height="54" class="aligncenter size-full wp-image-587" /></p>

<h3 id="slide-to-unlock8221-text">“Slide to unlock” text</h3>

<p>Now we’re getting somewhere! And now we’re approaching the limits of what we can do without getting pretty creative. We need some “slide to unlock” text in the background.</p>

<p>The first thing to do is to move the slider all the way to the left, to the default position. We do this through HTML by setting the value to 0:</p>

<pre name="code" class="HTML">&lt;input type="range" value="0"&gt;
</pre>

<p>Ok, that wasn’t too hard. But what about the text? We can’t modify anything in the input itself, because it doesn’t contain any element to display text. And we can’t dynamically add text with JavaScript, because again, it’s the shadow DOM! What we can do is create a separate text element outside of the input and position it on top of the slider using absolute positioning.</p>

<p>But this would be no good, since the text would appear over the button itself. What we want is for the text to show up in-between the button and the background. Since we can style both of these with CSS, we can control the stacking order with good old z-index!</p>

<p>And while we’re at it, we might as well animate the “spotlight” effect on the text. We can do this with a combination of a semitransparent -webkit-mask and animations (see below).</p>

<p>First we have the HTML, which has changed a bit. For positioning and grouping, we need a wrapped element for the input and the span of text:</p>

<pre name="code" class="HTML">&lt;div class="iphone-slider"&gt;
    &lt;input type="range" value="0"&gt;&lt;/input&gt;
    &lt;span&gt;slide to unlock&lt;/span&gt;
&lt;/div&gt;
</pre>

<p>The final complete CSS is as follows:</p>

<pre name="code" class="CSS">.iphone-slider {
    width: 280px;
    height: 46px;
    
    /* set the wrapper as the anchor element for positioning */
    position: relative;
}

.iphone-slider input {
    -webkit-appearance: none;
    width: 100%;
    background: #ddd;
    padding: 3px;
    border: 1px solid #525252;
    -webkit-border-radius: 15px;
    border-radius: 15px;
    background-image: -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #000000),
        color-stop(1, #222222)
    );
}

.iphone-slider input::-webkit-slider-thumb {
    -webkit-appearance: none;
    
    /* position the button on top of everything */
    z-index: 100;
    position: relative;
    
    width: 68px;
    height: 44px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    
    /* arrow and button gradient */
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAYCAYAAAB0kZQKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASJJREFUeNpi7OnpYaAC0AXiF0D8mhzNTAzUASBHnAdim4F0BAhIA/EBIC4aSEeAADMQ9wLxRiDmHyhHwIAfNHqMiXZEcXExGJMCiNCjCMTHgDiTkFmM////p4rXe3t78Rm0DIjTgfgLNkkWoGZQij7MQFsQBY2aICC+Rq80gQ2oA/EZIE4YSEeAACcQzwfimVD2gDgCBtKgiVZlIB0BAgbQbBwykI5A5I4BtPsaNLfcHKiQWADEJiAHDERIfAfiLKgjBiQ67kCD/zK2NAFqjMyi0AJQVnPCI78GiBNxFttQF6ZToVjG5ohfoLoOiKcMVO54BA3+swPVntgKxIbEOIAWjvgLxJVA7APE7waisHoKxBFAfGSgSszL0MLnBTmaAQIMAKg/OsrT7JG8AAAAAElFTkSuQmCC'),
    -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #fefefe),
        color-stop(0.49, #dddddd),
        color-stop(0.51, #d1d1d1),
        color-stop(1, #a1a1a1)
    );
    background-repeat: no-repeat;
    background-position: 50%;
}

.iphone-slider span {
    /* position the text just under the button in the stacking order */
    position: absolute;
    z-index: 99;
    top: 30%;
    left: 37%;
    
    font-family: "Helvetica Neue", Helvetica, sans;
    font-size: 24px;
    color: white;
    cursor: default;
    -webkit-user-select: none;
    
    /* semitransparent gradient mask to animate over the text */
    -webkit-mask-image: -webkit-gradient(
        linear,
        left top,
        right top,
        color-stop(0, rgba(0,0,0,0.3)),
        color-stop(0.45, rgba(0,0,0,0.3)),
        color-stop(0.5, rgba(0,0,0,1)),
        color-stop(0.55, rgba(0,0,0,0.3)),
        color-stop(1, rgba(0,0,0,0.3))
    );
    -webkit-mask-size: 1000px;
    -webkit-mask-repeat: no-repeat;
    -webkit-animation-timing-function: ease-in-out;
    -webkit-animation: text-spotlight 4s infinite;
}

/* animate the webkit-mark over the text */
@-webkit-keyframes text-spotlight {
  0% {
    -webkit-mask-position: -800px;
  }
  
  100% {
    -webkit-mask-position: 0px;
  }
}
</pre>

<p>This renders as the following:</p>

<p><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-mask.png" alt="" title="The final result" width="288" height="52" class="aligncenter size-full wp-image-589" /></p>

<p>Which looks pretty dang close the the native iPhone slider if I do say so myself! (perhaps the arrow could use some box-shadow to make it pop a bit more however).</p>

<h3 id="just-a-bit-of-javascript">Just a bit of JavaScript</h3>

<p>Since we’ve come this far, we might as well make the experience as authentic as possible. Here I’ve thrown in some JavaScript to check if the slider has been fully moved to the right, giving the user notification that the phone is unlocked.</p>

<p>Also, you’ll notice the opacity of the text slowly fade as the slider is moved farther to the right. This mimics the actual experience on the iPhone.</p>

<p>Here’s the JavaScript to make this work:</p>

<pre name="code" class="JScript">(function() {
  // variable declarations
  var slider, sliderInput, sliderButton, sliderText, sliderTimeout, sliderOnchange, unlockCheck;
  
  // cache our DOM elements in variables
  slider = document.querySelector('.iphone-slider');
  sliderInput = slider.querySelector('input');
  sliderButton = sliderInput.querySelector('::-webkit-slider-thumb');
  sliderText = slider.querySelector('span');
  
  /*
      Check if it's been unlocked, else return the
      button back to the left side (default position).
  */
  unlockCheck = function() {
    if(sliderInput.value == 100) {
      sliderText.innerHTML = 'Unlocked!';
      sliderInput.value = 0;
      sliderText.style.opacity = 1;
    } else {
      setTimeout(function(){
        sliderInput.value = 0;
        sliderText.style.opacity = 1;
      }, 1000);
    }
  };
  
  sliderOnchange = function() {
    /*
        Set the opacity of the text relative to the value
        on the input range.
    */
    sliderText.style.opacity = ((100 - sliderInput.value) / 200);
    
    /*
        Add a timeout to prevent the function from being called
        on EVERY onchange event.
    */
    clearTimeout(sliderTimeout);
    sliderTimeout = setTimeout(unlockCheck, 300);
  }
  
  slider.onchange = sliderOnchange;
})();
</pre>

<h3 id="live-example">Live example</h3>

<p>Here’s a <a href="http://www.youtube.com/watch?v=lC_pcRZgNm0">video</a> of the slider in action:  </p>

<p>If you’re running Safari or Chrome, you should be able to see and interact with the <a href="http://davidbcalhoun.com/a/iphone-slider.html">standalone demo</a>.</p>

<p>Sweet! Well, that was fun! This was some good practice of using a ton of good stuff: border radius, gradients, multiple backgrounds, data URI images, webkit-mask-image, webkit-animation, and of course styleable input ranges via webkit-slider-thumb.</p>

<p>UPDATE: <a href="http://peter.sh/2011/05/inspectable-shadow-dom-the-file-browser-and-new-default-avatars/">Chrome has now made the shadow DOM inspectable</a>.</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/javascript-news-resources">
			
				JavaScript News Resources</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-14T00:00:00-08:00" pubdate data-updated="true">Jan 14<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p>There’s an overwhelming amount of information being pumped out of the JavaScript community each week, but how do you keep up with it? Here’s some sources to keep you busy.</p>

<h3 id="twitter">Twitter</h3>

<p>This merits a category of its own. This has replaced the RSS reader for a lot of folks, or at the very least supplemented it.</p>

<p>I’ve consistently recommended <a href="http://twitter.com/#!/nathansmith/javascript/">Nathan Smith’s list of JavaScript folks</a>. When I’m diligent, I keep up with this several times a week and <a href="http://twitter.com/#!/franksvalli/favorites/">favorite items from the feed</a> to be considered for inclusion in that week’s <a href="http://jsmag.com/blog/">JSMag Blog update</a>.</p>

<h3 id="aggregators-and-communities">Aggregators and communities</h3>

<p><a href="http://www.delicious.com/recent/javascript">Delicious</a><br />
<a href="https://github.com/languages/JavaScript">Github</a><br />
Reddit: <a href="http://www.reddit.com/r/web_design/">web_design</a> and <a href="http://www.reddit.com/r/javascript/">javascript</a><br />
<a href="http://groups.google.com/group/jsmentors">JSMentors</a></p>

<h3 id="blogs">Blogs</h3>

<p><a href="http://www.google.com/reader/bundle/user%2F00060481582380134484%2Fbundle%2FJavaScript">JavaScript Google Reader bundle</a><br />
<a href="http://www.google.com/reader/bundle/user%2F00060481582380134484%2Fbundle%2FJavaScript%20People">JavaScript People Blogs – Google Reader bundle</a></p>

<p><a href="http://hacks.mozilla.org/articles/">Mozilla articles on hacks.mozilla.org</a><br />
<a href="http://msdn.microsoft.com/en-us/scriptjunkie/">Script Junkie</a><br />
<a href="http://dailyjs.com/">DailyJS</a> – very frequently updated news by Alex Young<br />
<a href="http://www.quirksmode.org/blog/">QuirksBlog (ppk)</a> – focus on mobile<br />
<a href="http://javascriptweblog.wordpress.com/">JavaScript, JavaScript (Angus Croll)</a><br />
<a href="http://ejohn.org/category/blog/">John Resig’s blog</a> – unfortunately not too active lately (check out <a href="http://twitter.com/#!/jeresig">his Twitter</a> for more updated info)<br />
<a href="http://ajaxian.com/">Ajaxian</a> – used to be THE source for news, but it isn’t updated too much anymore</p>

<p>…and many more. Check out <a href="http://blog.reybango.com/2010/12/15/what-to-read-to-get-up-to-speed-in-javascript/">Rey Bango’s “What to Read to Get Up to Speed in JavaScript”</a> for more.</p>

<h3 id="browser-blogs">Browser blogs</h3>

<p>It’s important to know what’s going down in the browser world. These have mixed content, so it’s not just JavaScript.</p>

<p><a href="http://webkit.org/blog/">Surfin’ Safari</a><br />
<a href="http://blog.chromium.org/">The Chromium Blog</a><br />
<a href="http://blog.mozilla.com/">The Mozilla Blog</a></p>

<h3 id="weekly-news">Weekly news</h3>

<p>These sources attempt to do the legwork for you and round up the most important articles each week. (Disclaimer: I currently write for JSMag!)</p>

<p><a href="http://javascriptweekly.com/">JavaScript Weekly</a>: a weekly email newsletter<br />
<a href="http://badassjs.com/">Badass JS</a><br />
<a href="http://jsmag.com/blog/">JSMag blog</a></p>

<h3 id="podcasts-and-videos">Podcasts and Videos</h3>

<p><a href="http://www.aminutewithbrendan.com/">A Minute With Brendan</a><br />
<a href="http://node.minutewith.com/">node.minutewith</a><br />
<a href="http://developer.yahoo.com/yui/theater/">YUI Theatre</a><br />
<a href="http://nodeup.com/">Node Up</a></p>

<p>Am I missing anything (I’m very sure)? Post a link below in the comments. Thanks!</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/what-happens-when-you-have-no-javascript-fallback">
			
				What Happens When You Have No JavaScript Fallback?</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-12T00:00:00-08:00" pubdate data-updated="true">Jan 12<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<p><a href="http://davidbcalhoun.com/wp-content/uploads/2011/01/twitter-fallback.png"><img src="http://davidbcalhoun.com/wp-content/uploads/2011/01/twitter-fallback.png" alt="" title="Twitter no-JavaScript fallback" width="1036" height="772" class="aligncenter size-full wp-image-556" /></a></p>

<p>Here’s an example of what happens when your interface completely relies on JavaScript. There’s code with translated <a href="http://en.wikipedia.org/wiki/Mojibake">mojibake</a> of some sort which caused the JavaScript to break. The code wasn’t in a try-catch block, so it caused all of the code on the page to fail, thus presenting me with the only part of the screen that wasn’t generated by JavaScript: the completely useless header.</p>

<p>Where’s the tweets!?</p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/how-to-spot-outdated-javascript">
			
				How to Spot Outdated JavaScript</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-07T00:00:00-08:00" pubdate data-updated="true">Jan 7<span>th</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<h3 id="introduction">Introduction</h3>

<p>Those that are just setting out to learn JavaScript are typically overwhelmed by the amount of online resources to be found about learning JavaScript. Not only this, but every webpage visited presents a potential learning opportunity just by inspecting the source.</p>

<p>However, not all resources are guaranteed to be up-to-date. JavaScript has been around for over a decade, and coding standards have changed drastically over time. While a code snippet may still work in today’s browsers, you may unknowingly be using an outdated practice that might eventually lead to a bit of embarrassment.</p>

<p>You may sometimes find these old practices mixed in with good and modern code. It seems that folks might learn new code styles without necessarily casting away all their old habits. So keep in mind not to throw out the baby with the bathwater!</p>

<p>Here’s some old practices that should help you spot old outdated code. </p>

<h3 id="global-variables">Global variables</h3>

<pre name="code" class="JScript">function foo() {  // global function
  greeting = 'Hello' + name;  // global function
};
name = 'James';  // global variable
foo();
</pre>

<p>Tons of global variables is a sure sign of outdated code. Ideally you want to aim to have at most one global variable, which is a namespace for all your code to be written under. All variables in your functions should be defined with the ‘var’ keyword to ensure they don’t break out of their scope.</p>

<p>Here’s an example where we defined one global variable entry point (myNamespace) for our code:</p>

<pre name="code" class="JScript">var myNamespace = (function() {
  // declare all variables with var
  var greeting, name;
  
  name = 'James';
  
  greeting = function() {
    return 'Hello ' + name;
  };
  
  return {
    greeting: greeting
  }
})();

greeting();              // ERROR: not defined
myNameSpace.greeting();  // 'Hello James'
</pre>

<h3 id="commented-cdata-blocks">Commented CDATA blocks</h3>

<pre name="code" class="JScript">/* &lt;![CDATA[ */
// code here
/* ]]&gt; */
</pre>

<p>This appears in old scripts that are presented inline (instead of externally in a separate file). The original purpose of those was to get around HTML validator errors (and to conform to XHTML), but that appears to no longer be an issue with validators today. Also, the usage of HTML validators itself seems to be waning, although they may sometimes be helpful in the development of websites.</p>

<h3 id="documentwrite">document.write()</h3>

<pre name="code" class="JScript">document.write('foo');
</pre>

<p>The <a href="http://dev.w3.org/html5/spec/apis-in-html-documents.html#document.write">W3C</a>, along with most everyone else, warns against using this, as it may result in overwriting (blanking) the entire page and other unwanted behavior.</p>

<p>It’s now used mostly by ads, and <a href="http://www.stevesouders.com/blog/2010/12/15/controljs-part-3/">developers have for years been trying to control them</a>. So don’t use it, unless you’re trying to prevent ads from using them. In other words, don’t use it unless you know what you’re doing.</p>

<h3 id="inlined-event-handlers">Inlined event handlers</h3>

<pre name="code" class="HTML">&lt;a onclick="myClickFunction()" href="http://foo.com"&gt;&lt;/a&gt;
&lt;a onmouseover="myMouseoverFunction()" href="http://foo.com"&gt;&lt;/a&gt;
&lt;form onsubmit="mySubmitFunction()" href="http://foo.com"&gt;&lt;/form&gt;
</pre>

<p>This mixes behavior with the actual content, which means when it’s time to make changes to the code, you likely have to change both the HTML and the JavaScript, instead of simply just the JavaScript. It also means that you may be serving useless content to users with JavaScript disabled (<a href="http://developer.yahoo.com/blogs/ydn/posts/2010/10/followup-how-many-users-have-javascript-disabled/">they’re still out there</a>, believe it or not). This also might have an affect on search engines, that might not be able to access this JavaScript-only content (although crawlers are getting more sophisticated and this may be less of an issue as time progresses).</p>

<p>Instead, the very least you can do is add IDs to each element (or better, use a JavaScript selector engine) and hook into them in your JavaScript, which makes the code much easier to maintain:</p>

<pre name="code" class="HTML">&lt;a id="link1" href="http://foo.com"&gt;&lt;/a&gt;
&lt;a id="link2" href="http://foo.com"&gt;&lt;/a&gt;
&lt;form id="myForm" href="http://foo.com"&gt;&lt;/form&gt;
</pre>

<pre name="code" class="JScript">(function() {  // sandbox everything
  // variable declarations
  var link1, link2, myForm;

  window.onload = function() {  // or onDOMContentLoaded (wait for DOM to be ready)
    // simple DOM selectors
    link1 = document.getElementById('link1');
    link2 = document.getElementById('link2');
    myForm = document.getElementById('myForm');
    
    // well-supported older event handler
    link1.onclick = function(){
      // code
    };
    
    // better (DOM2)
    link1.addEventListener('click', function(){ // or attachEvent for IE
      // code
    },false);
    
    // etc...
  }

})();
</pre>

<p>link1.onclick is widely supported, but there’s a few downsides, including the fact you can only add ONE event listener on the element (it will be overwritten if you try to add another). Use addEventListener (attachEvent in IE) instead, or the method of your favorite JavaScript engine.</p>

<p>In any case, the point here is to get the JavaScript out of the HTML and into the rest of your JavaScript.</p>

<h3 id="inline-javascript-in-link-hrefs">Inline JavaScript in link hrefs</h3>

<pre name="code" class="HTML">&lt;a href="javascript:doSomething()"&gt;&lt;/a&gt;
&lt;a href="javascript:void(0)"&gt;&lt;/a&gt;
</pre>

<p>Both of these examples commit the same error as above – mixing JavaScript behavior with the HTML content. And the solution is similar: find these links with JavaScript (most simply by adding an id on them) and hook into them there.</p>

<p>The second example brings up a good issue, and a point of contention. Ideally this would be a link to fallback content for users that have JavaScript disabled (and for search engines!), which would be a link to a new page (Flickr is an example of a modern site that uses this approach). For better or worse, however, you might be building a web app that only works with JavaScript, and you might want a link that only exists to kick off a JavaScript event.</p>

<p>You’ll find that removing the href value or making it blank (href=””) might remove the styling from the link and no longer makes it clickable. An easy fix is to set the href equal to a hash tag (href=”#”). A side effect might be a “jump” to the top of the page after clicking the link, which requires and requires e.preventDefault() within the attached event. Href=”#” may soon become an antipattern (or maybe it is already), since you can also fix this with CSS styling:</p>

<pre name="code" class="CSS">a { cursor: pointer; }
</pre>

<p>This gives the cursor a pointer when the user hovers over the link, even if it’s missing the href value.</p>

<p>But again, this isn’t generally recommended. It’s better to make a non-JavaScript fallback by linking to an actual page, then overriding it with e.preventDefault() for JavaScript-enabled users!</p>

<h3 id="slow-arrays">Slow arrays</h3>

<pre name="code" class="JScript">var arr = [1, 2, 3, 4, 5];

for(var x in arr) {
  /* code */
}

for(var i=0; i &lt; arr.length; i++) {
  /* code */
}
</pre>

<p>For-in loops turn out to be quite slow while going through arrays, so only use them when iterating through properties of an object. The second for loop is much faster, but can be made faster still when we realize what’s being evaluated on each iteration:</p>

<pre name="code" class="JScript">for(1; n; n) {}
</pre>

<p>The first statement is evaluated once (1 time) as the loop is initialized, and the second and third parts are evaluated on each run through the loop (n times). Because of this, just as removing fluff from the main body of the loop itself, we would also do well to remove fluff from these statements themselves. As it turns out, it’s quite slow finding the length of the array (arr.length) on each pass, and it’s not necessary to do it more than once since it’s not changing. So we can “cache” the length in a variable in the initializer:</p>

<pre name="code" class="JScript">for(var i=0, len=arr.length; i &lt; len; i++) {
  // code
}
</pre>

<p>And faster yet is a while loop (keep in mind that it will run backwards), which stops when the counter hits 0, which is falsy, causing the loop to stop:</p>

<pre name="code" class="JScript">var i = arr.length;
while(i--) {
  // code
}
</pre>

<h3 id="new-object-new-array-new-function-etc">new Object(), new Array(), new Function(), etc</h3>

<pre name="code" class="JScript">var obj  = new Object();
var arr  = new Array();
var func = new Function("param1", "param2", "return true;");
</pre>

<p>While these work, no one really uses them, as there exist less verbose and more common alternatives. Use these instead, which are exactly equal to the above code:</p>

<pre name="code" class="JScript">var obj  = {};
var arr  = [];
var func = function(param1, param1) {return true;}
</pre>

<h3 id="alert">alert()</h3>

<p>Ok, alert can sometimes still be useful for debugging, but generally you want to use console.log for that anyway. Generally you don’t want to ever prompt the user with alert() however. Its use on the desktop for mainstream use has long been discouraged.</p>

<p>I’m still on the fence about using alert() however, as I think it’s pretty useful and not necessarily ugly in mobile browsers. I’ll spare you and save that for another post.</p>

<h3 id="missing-semicolons">Missing semicolons</h3>

<pre name="code" class="JScript">var name='Bill'
alert('Hi ' + name)
</pre>

<p>The above code works fine because of a controversial feature of JavaScript called semicolon insertion. But doesn’t it make you feel dirty? It should, especially if you’ve read JavaScript: The Good Parts. Use semicolons for your own good and to prevent major headaches. Leave it to your JavaScript minifier to be clever in deciding when to remove them:</p>

<pre name="code" class="JScript">var name='Bill';
alert('Hi ' + name);
</pre>

<h3 id="code-for-particular-user-agents">Code for particular user agents</h3>

<p>This is also a bit controversial, since unfortunately user agent sniffing is still sometimes necessary. However, in the past it was really abused with code such as this:</p>

<pre name="code" class="JScript">isIE  = document.all;
isNS4 = document.layers;
isNS6 = document.getElementById;
if(isIE) {
  // code for IE
} else if(isNS4) {
  // code for Netscape 4
} else if(isNS6) {
  // code for Netscape 6
}
</pre>

<p>(did I mention that any references to ancient browsers like Netscape is also a surefire sign of old code? But that’s probably too obvious…)</p>

<p>This example detects browsers by features that only exist in each of these old browsers, but the same sin is committed by “sniffing” for words in the user agent string. The unfortunate result is fragmented code targeting each predetermined browser. Not to mention that it’s not future-proof, as it can’t properly anticipate newer browsers.</p>

<p>The better method? If there’s a question about the availability of a method, simply check for it first before using it:</p>

<pre name="code" class="JScript">if(document.addEventListener) {  // detect addEventListener
  // Try the standard first
  document.addEventListener('click', function(){}, false);
} else if(document.attachEvent) {  // detect attachEvent
  // Typically IE
  document.attachEvent('onclick', function(){});
}
</pre>

<p>This code is considered feature detection, which is much more acceptable. It also anticipates newer browsers such as IE9, which support addEventListener. This makes sure the code you write doesn’t condemn Internet Explorer to forever use attachEvent.</p>

<h3 id="related-links">Related links</h3>

<p>Christian Heilmann and PPK’s old posts inspired me to write this brief post. You can read much better rationale against using some of the things above at these links:</p>

<p><a href="http://www.wait-till-i.com/2005/06/21/six-javascript-features-we-do-not-need-any-longer/">Six JavaScript features we do not need any longer (Christian Heilmann, 2005)</a></p>

<p><a href="http://icant.co.uk/articles/from-dhtml-to-dom/from-dhtml-to-dom-scripting.html">From DHTML to DOM scripting (Christian Heilmann, 2006)</a></p>

<p><a href="http://www.quirksmode.org/blog/archives/2005/06/three_javascrip_1.html">Three JavaScript articles and one best practice (PPK 2005)</a></p>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/2011/what-is-a-closure-in-javascript">
			
				What Is a Closure in JavaScript?</a>
		</h2>
		<div class="meta date">








  


<time datetime="2011-01-03T00:00:00-08:00" pubdate data-updated="true">Jan 3<span>rd</span>, 2011</time></div>
	</header>
	<div class="entry-content">
		<h3 id="intro">Intro</h3>

<p>There have been many attempts to answer this question in a succinct way, but I haven’t really been satisfied by them. Here’s my attempt at a (relatively) concise explanation.</p>

<p>This is adapted from a <a href="http://www.reddit.com/r/javascript/comments/eti86/can_somebody_explain_closures_to_me/c1atir1">reply I posted on reddit</a> which people seemed to have found useful.</p>

<h3 id="broad-definition">Broad definition</h3>

<p>Normally when people talk about closures in JavaScript, they’re talking about methods and properties that outlive the scope of their original function (more on that in a second), but actually the definition is a bit broader. A closure is how a function “closes over” (Crockford) its variables and creates a different scope for them out of the way of the global [window] scope. So an understanding of closures will require some understanding of scope, which is definitely a common stumbling block in first learning JavaScript.</p>

<p>Essentially, closures make this possible:</p>

<pre name="code" class="JScript">var a = 1;
function(){
  var a = 2;
  a; // 2 (functional scope)
};
a;  // 1 (global scope)
</pre>

<h3 id="variables-that-survive-after-function-execution">Variables that survive after function execution</h3>

<p>But when people get excited about closures, they’re not really talking about the example above, but about the ability for functional variables to outlive their original functional scope:</p>

<pre name="code" class="JScript">var b = function() {
  var myPrivateVar = 'Foo';
  var myPublicVar = 'Bar';

  return myPublicVar;
};

b();  // 'Bar'
myPrivateVar;  // ERROR (not defined, because it was only defined in functional scope and is trying to be accessed from the global [window] scope)
myPublicVar;   // ERROR (not defined)
</pre>

<p>But note that the original method name (myPublicVar) isn’t available – but the value IS available from what we exposed to the global scope through the variable ‘b’.</p>

<h3 id="closures-and-the-module-pattern">Closures and the Module Pattern</h3>

<p>How is this useful? This turns out to be the foundation for the Module Pattern in JavaScript – the building block of modern JavaScript applications. They’re in essence a glorified version of the block of code above, with the purpose of hiding the function’s private variables (this comes by default when declaring variables with the ‘var’ keyword in functions), and exposing public variables. And note that because functions are first class in JavaScript, those variables can even be references to functions themselves!</p>

<p>So in essence this is the module pattern, with both private and public properties and methods:</p>

<pre name="code" class="JScript">var myAPI = (function() {
  var privateProperty = 'Foo';
  var publicProperty = 'Bar';

  var privateMethod = function() {
    alert('I can only be executed from the scope of myAPI');
  };

  var publicMethod = function() {
    alert('I am publicly accessible (through the global scope) because a reference to publicMethod is returned by myAPI');
  };

  // set up an object whose own property names (on the left) match the references to the internal, functionally-scoped methods (on the right)
  var publicStuff = {
    publicProperty: publicProperty,
    publicMethod: publicMethod
  };

  // return our public object (myAPI is now equal to this object)
  return publicStuff;
})();   // immediately execute myAPI as a function, which returns an object that contains pointers to stuff in myAPI, which is exposed through myAPI.x, myAPI.y, etc
</pre>

<p>By the time we reach the last line of the above script, the function has stopped executing, but some original pieces of the function still live on! Because some references to functional variables were returned by the function, we can now access these through the “namespace” myAPI:</p>

<pre name="code" class="JScript">myAPI.publicProperty;  // 'Bar'
myAPI.publicMethod(); // (alert: 'I am publicly accessible'...)
</pre>

<p>But those variables that were not exposed are of course not accessible:</p>

<pre name="code" class="JScript">myAPI.privateProperty;  // error (not defined)
myAPI.privateMethod(); // error (not defined)
</pre>

<h3 id="access-to-unexposed-variables">Access to unexposed variables</h3>

<p>Exposed public methods still have the context of the original function, meaning that they have access to all the function’s variables, public and private:</p>

<pre name="code" class="JScript">var myAPI = (function(){
  var privateProperty = 'Foo';

  var publicFunction = function() {
    // this function has access to privateProperty because it's in the same scope, even after the main function stops executing!
    return privateProperty;
  };
  
  // create a new object and return it
  return {
    publicFunction: publicFunction
  };
})();

privateProperty;         // ERROR (not defined)
myAPI.publicFunction();  // 'Foo'
</pre>

<p>There’s definitely more to be said here, but hopefully this helps!</p>


		
		
	</div>

</article>

<nav id="pagenavi">
    
        <a href="/blog/page/4/" class="prev">Previous</a>
    
    
        <a href="/blog/page/6/" class="next">Next</a>
    
</nav>
</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2015
<a href="mailto:david.b.calhoun@gmail.com">David Calhoun</a> (<a href="https://twitter.com/franksvalli">@franksvalli</a>) - <a href="https://www.linkedin.com/in/davidcalhoun">LinkedIn</a> - <a href="http://themaingate.net/resume/">Resume</a></footer>
	<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script> -->
<!-- <script src="/javascripts/hyphenator.js"></script> -->


<script type="text/javascript">
      var disqus_shortname = 'davidbcalhoun';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script src="/javascripts/main.js"></script>
<!-- <script src="/javascripts/negative-scroll-blur.js"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5530615-3', 'davidbcalhoun.com');
  ga('send', 'pageview');

</script>

</body>
</html>
