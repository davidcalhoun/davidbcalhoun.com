<!doctype html>
<html lang="en-US">
<head>
	<meta charset="utf-8">
	<title>What happens when we serve JavaScript with random MIME types?  | David Calhoun</title>

	<meta name="author" content="David Calhoun">

<meta name="description" content="What Happens When We Serve JavaScript With Random MIME Types? Nov 1st, 2010 12:00 am Introduction When people started to learn about the HTML5 &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="David Calhoun" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="/javascripts/html5.js"></script><![endif]-->
	

</head>



<body>
	<header id="header" class="inner" role="banner" aria-labelledby="header_title"><h1><a href="/" id="header_title">David Calhoun</a></h1>
<span class="tagline"></span>

</header>
	<div id="content" class="inner" role="main"><article class="post" role="main" itemscope itemType="http://schema.org/BlogPosting">
	<meta itemprop="inLanguage" content="en-US" />
	<span itemscope itemprop="author" itemType="https://schema.org/Person">
		<meta itemprop="name" content="David Calhoun" />
	</span>
	<span itemscope itemprop="publisher" itemType="https://schema.org/Organization">
		<meta itemprop="name" content="David Calhoun" />
		<meta itemprop="url" content="http://themaingate.net" />
		<meta itemprop="logo" content="http://themaingate.net/david-calhoun-logo.png">
	</span>
	<meta itemprop="image" content="http://themaingate.net/david-calhoun-logo.png">
	<header>
		<h2 class="title" itemprop="headline"><a itemprop="url" href="">What Happens When We Serve JavaScript With Random MIME Types?</a></h2>
		



<span class="meta date" itemprop="datePublished dateModified" content="2010-11-01 00:00:00 -0700" datetime="2010-11-01 00:00:00 -0700"><time class='entry-date' datetime='2010-11-01'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2010</span></span> <span class='time'>12:00 am</span></time></span>
	</header>
	<div class="entry-content" itemprop="articleBody"><h3 id="introduction">Introduction</h3>

<p>When people started to learn about the HTML5 doctype, they kind of freaked out a little, not knowing how older browsers would handle it. A <a href="http://www.dustindiaz.com/skinny-on-doctypes/">post by Dustin Diaz</a> prompted me to test out how pages rendered (in QuirksMode or Standards Mode) with a little help from</p>

<div class="codecolorer-container text twitlight" style="overflow:auto;white-space:nowrap;width:435px;">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td class="line-numbers">
        <div>
          1<br />
        </div>
      </td>
      
      <td>
        <div class="text codecolorer">
          document.compatMode
        </div>
      </td>
    </tr>
  </table>
</div>

<p>, and <a href="http://themaingate.net/dev/html/all-you-need-is-doctype-html">I found that surprisingly every browser rendered in Standards Mode with the new doctype</a>. In other words, no need to worry!</p>

<p>There’s another welcome simplification (<a href="http://davidbcalhoun.com/2010/top-ten-things-html5-makes-simpler">along with others</a>): the “type” attribute is no longer necessary on script tags:</p>

<blockquote>
  <p>The type attribute gives the language of the script or format of the data. If the attribute is present, its value must be a valid MIME type. The charset parameter must not be specified. <strong>The default, which is used if the attribute is absent, is “text/javascript”.</strong> <a href="http://dev.w3.org/html5/spec/Overview.html#script">-W3C HTML5 spec</a></p>
</blockquote>

<p>Which means that this is all that’s required now:</p>

<pre name="code" class="html">&lt;script src="script.js"&gt;&lt;/script&gt;
</pre>

<p>But how do older browsers handle this? Also, what if we send some crazy Content-Type back in the response header? To make matters more confusing, I noticed that different CDNs send back different Content-Types: <a href="http://yui.yahooapis.com/3.2.0/build/yui/yui-min.js">YUI</a> and <a href="http://code.jquery.com/jquery-1.4.3.min.js">jQuery</a>‘s CDNs send back “application/x-javascript” whereas <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js">Google’s CDN</a> serving jQuery sends back “text/javascript; charset=UTF-8″.</p>

<p>So does it really matter what the Content-Type is? Let’s find out!</p>

<h3 id="setting-up-the-tests">Setting up the tests</h3>

<p>The test is fairly simple: I have six JavaScript files that all write to the DOM when they’re executed successfully. Each of these files has a different file extension (js.one, js.two, js.three, etc) and each is served with an extension determined by the .htaccess file, which is in the same directory, and contains this bit of magic:</p>

<pre>AddType text/javascript .one
AddType application/x-javascript .two
AddType application/javascript .three
AddType text/ecmascript .four
AddType text/jscript .five
AddType text/foo .six
</pre>

<p>My index.html contains a little helper utility for each of these scripts to use:</p>

<pre name="code" class="JScript">var TEST = {
  node: document.body,
  addMessage: function(message) {
    var p = document.createElement('p');
    p.innerHTML = message;
    this.node.appendChild(p);
  }
}
</pre>

<p>TEST.addMessage() is simply a glorified document.write. As each of the six scripts is run, they’ll write out a message to the page essentially saying “I’m here! It worked!”.</p>

<h3 id="results">Results</h3>

<p>All the browsers I tested worked better than expected. It turns out that Content-Type doesn’t even matter. I made up my own content type “text/foo”, served the file successfully, and it still executed as JavaScript!</p>

<p>I tried all the major A-grade browsers (yes, including IE6-8), plus other random browsers through <a href="http://browsershots.org/">Browsershots.org</a>.</p>

<p>One thing I still need to try is IE9, which <a href="http://twitter.com/#!/paul_irish/status/29416115232">Paul Irish said may not work</a>. I’ll give it a test… soon.</p>

<h3 id="additional-test-1-playing-with-the-8220type8221-attribute">Additional test #1: playing with the “type” attribute</h3>

<p>Instead of messing around with the MIME type sent back in the response header, what happens when we mess around with the “type” attribute on the script tag? For instance:</p>

<pre name="code" class="HTML">&lt;script type="text/foo"&gt;&lt;/script&gt;
</pre>

<p>Using the same testing technique as above, I found these results to be more pronounced. Browsers were more picky. For instance, Chrome and Safari ran all the content types successfully except my made-up “text/foo”. Firefox was even more picky, choosing not to recognize the type “text/jscript”. I’d imagine there’s similar results with other browsers such as IE.</p>

<p>…But none of that really matters now! Simply omit the type attribute and everything seems to work fine (except possibly not in IE9?).</p>

<h3 id="additional-test-2-content-type-and-caching">Additional test #2: content type and caching</h3>

<p><a href="http://twitter.com/#!/bluesmoon/status/29418676869">Philip Tellis</a> wanted to know if Content-Type had any bearing on how the browser caches data. For instance, if something previously requested has the same filename but a different content type, is there a cache hit (304 code returned) or miss?</p>

<p>In the first test I made a page that requested a file. Then in a not-too-fancy way I changed the content type through .htaccess on the fly and made another request. A 304 code was returned even with the new content type, so it was clear that this traditional caching method wasn’t affected.</p>

<p>In my second test I instead changed the “type” attribute on the script tag itself (in the HTML). The file was still cached normally, even after the type changed.</p>

<p>I only tested in Chrome, Safari, and Firefox, so the story might be different in IE. Anyhow, this is an edge case anyway and more of a test out of curiosity! It seems the way browsers handle caching in these instances is truly RESTful, that is, the current state of the file is determined entirely by the filename.</p>

</div>



<section id="comment">
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</article></div>
	<footer id="footer" class="inner" role="contentinfo"><br>
<br>
<br>
<br>
&copy; 2017
<span itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="David Calhoun"><a href="mailto:david.b.calhoun@gmail.com" itemprop="email">David Calhoun</a> (<a href="https://twitter.com/franksvalli" itemprop="url">@franksvalli</a>) - <a href="https://www.linkedin.com/in/davidcalhoun" itemprop="url">LinkedIn</a> - <a href="http://themaingate.net/resume/" itemprop="url">Resume</a></span></footer>
	<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/slash.js"></script> -->
<!-- <script src="/javascripts/hyphenator.js"></script> -->


<script type="text/javascript">
      var disqus_shortname = 'davidbcalhoun';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://davidbcalhoun.com/2010/what-happens-when-we-serve-javascript-with-random-mime-types';
        var disqus_url = 'http://davidbcalhoun.com/2010/what-happens-when-we-serve-javascript-with-random-mime-types';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script src="/javascripts/main.js" defer></script>
<!-- <script src="/javascripts/negative-scroll-blur.js"></script> -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5530615-3', 'davidbcalhoun.com');
  ga('send', 'pageview');

</script>

</body>
</html>
