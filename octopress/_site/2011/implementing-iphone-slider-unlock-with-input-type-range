<p>(check out the live <a href='http://davidbcalhoun.com/a/iphone-slider.html'>demo</a>)</p>

<h3 id='introduction'>Introduction</h3>

<p>After reading <a href='http://glazkov.com/2011/01/14/what-the-heck-is-shadow-dom/'>&#8220;What the Heck is Shadow DOM?&#8221;</a> I was inspired to see how far I could style the <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;input type=&quot;range&quot;&gt; element. Pretty far, as it turns out!</pre></p>

<p>My goal was to change the input&#8217;s default appearance:</p>
<img alt='The default appearance for input type=range' class='aligncenter size-full wp-image-567' height='25' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range.png' title='The default appearance for input type=range' width='144' />
<p>To the visual appearance of the iPhone&#8217;s unlock slider:</p>
<img alt='The iPhone&apos;s unlock slider' class='aligncenter size-full wp-image-566' height='69' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-native.png' title='The iPhone&apos;s unlock slider' width='300' />
<p>As far as I can tell, only WebKit-based browsers and Opera have implemented input type=&#8221;range&#8221;. Mobile Safari hasn&#8217;t yet implemented it as of iOS 4.2 and Android also hasn&#8217;t fully implemented it as of Android 2.3 (although curiously the elements are styleable but not yet interactive). Surprisingly, the only mobile OS to implement this input type seems to be BlackBerry OS 6.</p>

<p>However, the focus here will be to get this working on just Chrome and WebKit. This will make it a bit easier to do this proof of concept. So we&#8217;ll be using lots of &#8220;-webkit&#8221; vendor prefixed CSS.</p>

<h3 id='what_we_have_to_work_with'>What we have to work with</h3>

<p>Of course we have our simple range input:</p>
<pre class='html' name='code'>&lt;input type="range"&gt;
</pre>
<p>Which looks like this:</p>
<img alt='The default appearance for input type=range' class='aligncenter size-full wp-image-567' height='25' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range.png' title='The default appearance for input type=range' width='144' />
<p>We can target the input itself with a CSS attribute selector:</p>
<pre class='CSS' name='code'>input[type='range'] {}
</pre>
<p>And if we want, we can transform it into a vertical slider by changing the &#8220;-webkit-appearance&#8221; property:</p>
<pre class='CSS' name='code'>input[type='range'] {
    -webkit-appearance: slider-vertical;
}
</pre>
<p>Which looks like this:</p>
<img alt='Input range in a vertical orientation' class='aligncenter size-full wp-image-579' height='119' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-vertical.png' title='Input range in a vertical orientation' width='25' />
<p>If we want to style it as if it was any other element, there&#8217;s a slight catch, as we first have to set &#8220;-webkit-appearance&#8221; to &#8220;none&#8221; and then add our customizations (this appears to mean that we can&#8217;t actually style vertical sliders&#8230;). Here we&#8217;ll set the background color as a simple demo:</p>
<pre class='CSS' name='code'>input[type='range'] {
    -webkit-appearance: none;
    background-color: gray;
}
</pre>
<p>This outputs the following:</p>
<img alt='Input range with a gray background' class='aligncenter size-full wp-image-577' height='15' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-gray-background.png' title='Input range with a gray background' width='129' />
<p>Most interestingly, we can target and style the slider button itself with CSS, although we can&#8217;t get access to it with JavaScript (for the time being anyhow). Here we&#8217;ll style it a slightly darker shade of gray:</p>
<pre class='CSS' name='code'>input[type='range'] {
    -webkit-appearance: none;
    background-color: gray;
}

input[type='range']::-webkit-slider-thumb {
    -webkit-appearance: none;
    background-color: #444;
    width: 15px;
    height: 20px;
}
</pre>
<p>Which results in this:<br /><img alt='Input range with a gray background and a slightly darker slider control' class='aligncenter size-full wp-image-583' height='20' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/input-range-styled.png' title='Input range with a gray background and a slightly darker slider control' width='129' /></p>

<p>Now all the pieces are in place to fully style the input!</p>

<h3 id='styling_the_background'>Styling the background</h3>

<p>This part&#8217;s no big deal. We just want to set up the width/height, slap on some handy rounded corners, and add a very slight background gradient:</p>
<pre class='CSS' name='code'>input[type='range'] {
    -webkit-appearance: none;
    width: 280px;
    height: 46px;
    padding: 3px;
    -webkit-border-radius: 15px;
    border-radius: 15px;
    border: 1px solid #525252;
    background-image: -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #000000),
        color-stop(1, #222222)
    );
}
</pre>
<p>Now we have the backdrop in place:</p>
<img alt='iPhone slider background' class='aligncenter size-full wp-image-585' height='54' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-background.png' title='iPhone slider background' width='288' />
<h3 id='styling_the_button'>Styling the button</h3>

<p>To get the button, we&#8217;ll add some width/height and rounded corners. Here we&#8217;ll also need a more complicated background gradient as well as an arrow icon. Your first instinct might be to add more markup to hook the arrow icon to, but remember that this is impossible. We&#8217;re working in the &#8220;shadow DOM&#8221; of elements created and maintained by the browser itself. We can style the existing elements but we can&#8217;t create any new ones.</p>

<p>So what do we do? Take advantage of multiple backgrounds! We can specify the background as both the arrow image and the gradient we need. In this case we&#8217;ll also base64 encode the small image to avoid an extra HTTP request.</p>

<p>The CSS for the button looks like this:</p>
<pre class='CSS' name='code'>input[type='range']::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 68px;
    height: 44px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAYCAYAAAB0kZQKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASJJREFUeNpi7OnpYaAC0AXiF0D8mhzNTAzUASBHnAdim4F0BAhIA/EBIC4aSEeAADMQ9wLxRiDmHyhHwIAfNHqMiXZEcXExGJMCiNCjCMTHgDiTkFmM////p4rXe3t78Rm0DIjTgfgLNkkWoGZQij7MQFsQBY2aICC+Rq80gQ2oA/EZIE4YSEeAACcQzwfimVD2gDgCBtKgiVZlIB0BAgbQbBwykI5A5I4BtPsaNLfcHKiQWADEJiAHDERIfAfiLKgjBiQ67kCD/zK2NAFqjMyi0AJQVnPCI78GiBNxFttQF6ZToVjG5ohfoLoOiKcMVO54BA3+swPVntgKxIbEOIAWjvgLxJVA7APE7waisHoKxBFAfGSgSszL0MLnBTmaAQIMAKg/OsrT7JG8AAAAAElFTkSuQmCC'),
    -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #fefefe),
        color-stop(0.49, #dddddd),
        color-stop(0.51, #d1d1d1),
        color-stop(1, #a1a1a1)
    );
    background-repeat: no-repeat;
    background-position: 50%;
}
</pre>
<p>Which outputs this:<br /><img alt='' class='aligncenter size-full wp-image-587' height='54' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-button.png' title='iPhone slider button styled' width='288' /></p>

<h3 id='slide_to_unlock_text'>&#8220;Slide to unlock&#8221; text</h3>

<p>Now we&#8217;re getting somewhere! And now we&#8217;re approaching the limits of what we can do without getting pretty creative. We need some &#8220;slide to unlock&#8221; text in the background.</p>

<p>The first thing to do is to move the slider all the way to the left, to the default position. We do this through HTML by setting the value to 0:</p>
<pre class='HTML' name='code'>&lt;input type="range" value="0"&gt;
</pre>
<p>Ok, that wasn&#8217;t too hard. But what about the text? We can&#8217;t modify anything in the input itself, because it doesn&#8217;t contain any element to display text. And we can&#8217;t dynamically add text with JavaScript, because again, it&#8217;s the shadow DOM! What we can do is create a separate text element outside of the input and position it on top of the slider using absolute positioning.</p>

<p>But this would be no good, since the text would appear over the button itself. What we want is for the text to show up in-between the button and the background. Since we can style both of these with CSS, we can control the stacking order with good old z-index!</p>

<p>And while we&#8217;re at it, we might as well animate the &#8220;spotlight&#8221; effect on the text. We can do this with a combination of a semitransparent -webkit-mask and animations (see below).</p>

<p>First we have the HTML, which has changed a bit. For positioning and grouping, we need a wrapped element for the input and the span of text:</p>
<pre class='HTML' name='code'>&lt;div class="iphone-slider"&gt;
    &lt;input type="range" value="0"&gt;&lt;/input&gt;
    &lt;span&gt;slide to unlock&lt;/span&gt;
&lt;/div&gt;
</pre>
<p>The final complete CSS is as follows:</p>
<pre class='CSS' name='code'>.iphone-slider {
    width: 280px;
    height: 46px;
    
    /* set the wrapper as the anchor element for positioning */
    position: relative;
}

.iphone-slider input {
    -webkit-appearance: none;
    width: 100%;
    background: #ddd;
    padding: 3px;
    border: 1px solid #525252;
    -webkit-border-radius: 15px;
    border-radius: 15px;
    background-image: -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #000000),
        color-stop(1, #222222)
    );
}

.iphone-slider input::-webkit-slider-thumb {
    -webkit-appearance: none;
    
    /* position the button on top of everything */
    z-index: 100;
    position: relative;
    
    width: 68px;
    height: 44px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    
    /* arrow and button gradient */
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAYCAYAAAB0kZQKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASJJREFUeNpi7OnpYaAC0AXiF0D8mhzNTAzUASBHnAdim4F0BAhIA/EBIC4aSEeAADMQ9wLxRiDmHyhHwIAfNHqMiXZEcXExGJMCiNCjCMTHgDiTkFmM////p4rXe3t78Rm0DIjTgfgLNkkWoGZQij7MQFsQBY2aICC+Rq80gQ2oA/EZIE4YSEeAACcQzwfimVD2gDgCBtKgiVZlIB0BAgbQbBwykI5A5I4BtPsaNLfcHKiQWADEJiAHDERIfAfiLKgjBiQ67kCD/zK2NAFqjMyi0AJQVnPCI78GiBNxFttQF6ZToVjG5ohfoLoOiKcMVO54BA3+swPVntgKxIbEOIAWjvgLxJVA7APE7waisHoKxBFAfGSgSszL0MLnBTmaAQIMAKg/OsrT7JG8AAAAAElFTkSuQmCC'),
    -webkit-gradient(
        linear,
        left top,
        left bottom,
        color-stop(0, #fefefe),
        color-stop(0.49, #dddddd),
        color-stop(0.51, #d1d1d1),
        color-stop(1, #a1a1a1)
    );
    background-repeat: no-repeat;
    background-position: 50%;
}

.iphone-slider span {
    /* position the text just under the button in the stacking order */
    position: absolute;
    z-index: 99;
    top: 30%;
    left: 37%;
    
    font-family: "Helvetica Neue", Helvetica, sans;
    font-size: 24px;
    color: white;
    cursor: default;
    -webkit-user-select: none;
    
    /* semitransparent gradient mask to animate over the text */
    -webkit-mask-image: -webkit-gradient(
        linear,
        left top,
        right top,
        color-stop(0, rgba(0,0,0,0.3)),
        color-stop(0.45, rgba(0,0,0,0.3)),
        color-stop(0.5, rgba(0,0,0,1)),
        color-stop(0.55, rgba(0,0,0,0.3)),
        color-stop(1, rgba(0,0,0,0.3))
    );
    -webkit-mask-size: 1000px;
    -webkit-mask-repeat: no-repeat;
    -webkit-animation-timing-function: ease-in-out;
    -webkit-animation: text-spotlight 4s infinite;
}

/* animate the webkit-mark over the text */
@-webkit-keyframes text-spotlight {
  0% {
    -webkit-mask-position: -800px;
  }
  
  100% {
    -webkit-mask-position: 0px;
  }
}
</pre>
<p>This renders as the following:</p>
<img alt='' class='aligncenter size-full wp-image-589' height='52' src='http://davidbcalhoun.com/wp-content/uploads/2011/01/iphone-slider-mask.png' title='The final result' width='288' />
<p>Which looks pretty dang close the the native iPhone slider if I do say so myself! (perhaps the arrow could use some box-shadow to make it pop a bit more however).</p>

<h3 id='just_a_bit_of_javascript'>Just a bit of JavaScript</h3>

<p>Since we&#8217;ve come this far, we might as well make the experience as authentic as possible. Here I&#8217;ve thrown in some JavaScript to check if the slider has been fully moved to the right, giving the user notification that the phone is unlocked.</p>

<p>Also, you&#8217;ll notice the opacity of the text slowly fade as the slider is moved farther to the right. This mimics the actual experience on the iPhone.</p>

<p>Here&#8217;s the JavaScript to make this work:</p>
<pre class='JScript' name='code'>(function() {
  // variable declarations
  var slider, sliderInput, sliderButton, sliderText, sliderTimeout, sliderOnchange, unlockCheck;
  
  // cache our DOM elements in variables
  slider = document.querySelector('.iphone-slider');
  sliderInput = slider.querySelector('input');
  sliderButton = sliderInput.querySelector('::-webkit-slider-thumb');
  sliderText = slider.querySelector('span');
  
  /*
      Check if it's been unlocked, else return the
      button back to the left side (default position).
  */
  unlockCheck = function() {
    if(sliderInput.value == 100) {
      sliderText.innerHTML = 'Unlocked!';
      sliderInput.value = 0;
      sliderText.style.opacity = 1;
    } else {
      setTimeout(function(){
        sliderInput.value = 0;
        sliderText.style.opacity = 1;
      }, 1000);
    }
  };
  
  sliderOnchange = function() {
    /*
        Set the opacity of the text relative to the value
        on the input range.
    */
    sliderText.style.opacity = ((100 - sliderInput.value) / 200);
    
    /*
        Add a timeout to prevent the function from being called
        on EVERY onchange event.
    */
    clearTimeout(sliderTimeout);
    sliderTimeout = setTimeout(unlockCheck, 300);
  }
  
  slider.onchange = sliderOnchange;
})();
</pre>
<h3 id='live_example'>Live example</h3>

<p>Here&#8217;s a <a href='http://www.youtube.com/watch?v=lC_pcRZgNm0'>video</a> of the slider in action:</p>

<p>If you&#8217;re running Safari or Chrome, you should be able to see and interact with the <a href='http://davidbcalhoun.com/a/iphone-slider.html'>standalone demo</a>.</p>

<p>Sweet! Well, that was fun! This was some good practice of using a ton of good stuff: border radius, gradients, multiple backgrounds, data URI images, webkit-mask-image, webkit-animation, and of course styleable input ranges via webkit-slider-thumb.</p>

<p>UPDATE: <a href='http://peter.sh/2011/05/inspectable-shadow-dom-the-file-browser-and-new-default-avatars/'>Chrome has now made the shadow DOM inspectable</a>.</p>