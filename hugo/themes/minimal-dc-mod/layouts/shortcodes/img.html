{{ $width := .Get "width" | int }}
{{ $height := .Get "height" | int }}
{{ $orientation := "landscape" }}
{{ if lt $width $height }}
    {{ $orientation = "portrait" }}
{{ end }}

<!-- The shortcode functionality - in layouts/shortcodes/img.html -->
  {{ if .Get "caption"}}
  <figure itemprop="image" itemscope itemtype="https://schema.org/ImageObject" class="center {{ $orientation }}">
  {{ end }}
    <a href="/wp-content/uploads/{{ .Get "src" }}-2000px-resize.jpeg" class="picture">
      <picture>
        <span itemscope itemprop="author" itemtype="https://schema.org/Person">
            <meta itemprop="name" content="David Calhoun" />
            <meta itemprop="url" content="https://www.themaingate.net" />
        </span>
        {{ if .Get "caption" }}
        <meta itemprop="caption" content="{{ .Get "caption" }}" />
        {{ end }}
        {{ if .Get "title" }}
        <meta itemprop="name" content="{{ .Get "title" }}" />
        {{ end }}
        {{ if .Get "width" }}
        <meta itemprop="width" content="{{ .Get "width" }}" />
        {{ end }}
        {{ if .Get "height" }}
        <meta itemprop="height" content="{{ .Get "height" }}" />
        {{ end }}
        <span itemscope itemprop="thumbnail" itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="/wp-content/uploads/{{ .Get "src" }}-500px-resize.jpeg" />
        </span>
        {{ if .Get "genre" }}
        <meta itemprop="genre" content="{{ .Get "genre" }}" />
        {{ end }}
        {{ if .Get "keywords" }}
        <meta itemprop="keywords" content="{{ .Get "keywords" }}" />
        {{ end }}
        {{ if .Get "location" }}
        <span itemprop="contentLocation" itemscope itemtype="http://schema.org/Place">
            <meta itemprop="address" content="{{ .Get "location" }}">
            {{ if .Get "latitude" }}
            <span itemprop="geo" itemscope itemtype="http://schema.org/GeoCoordinates">
                <meta itemprop="latitude" content="{{ .Get "latitude"}}" />
                <meta itemprop="longitude" content="{{ .Get "longitude"}}" />
                {{ if .Get "altitudeMeters" }}
                <meta itemprop="elevation" content="{{ .Get "altitudeMeters"}}" />
                {{ end }}
            </span>
            <meta itemprop="latitude" content="{{ .Get "latitude" }}">
            {{ end }}
            {{ if .Get "longitude" }}
            <meta itemprop="longitude" content="{{ .Get "longitude" }}">
            {{ end }}
        </span>
        {{ end }}
        <meta itemprop="isFamilyFriendly" content="true" />

        <source type="image/webp" media="(max-width: 500px)" srcset="/wp-content/uploads/{{ .Get "src" }}-500px-resize.webp" />
        <source type="image/webp" media="(max-width: 1000px)" srcset="/wp-content/uploads/{{ .Get "src" }}-1000px-resize.webp" />
        <source type="image/webp" media="(min-width: 1001px)" srcset="/wp-content/uploads/{{ .Get "src" }}-2000px-resize.webp" />

        <source type="image/jpeg" media="(max-width: 500px)" srcset="/wp-content/uploads/{{ .Get "src" }}-500px-resize.jpeg" />
        <source type="image/jpeg" media="(max-width: 1000px)" srcset="/wp-content/uploads/{{ .Get "src" }}-1000px-resize.jpeg" />
        <source type="image/jpeg" media="(min-width: 1001px)" srcset="/wp-content/uploads/{{ .Get "src" }}-2000px-resize.jpeg" />

        <img itemprop="url" src="/wp-content/uploads/{{ .Get "src" }}-2000px-resize.jpeg" loading="lazy" alt="{{ .Get "title" }}" width="{{ .Get "width" }}" height="{{ .Get "height" }}" />
      </picture>
    </a>
  {{ if .Get "caption"}}
    <figcaption>{{ .Get "caption" }}</figcaption>
  </figure>
  {{ end }}