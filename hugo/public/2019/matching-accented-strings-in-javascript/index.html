<!DOCTYPE html>
<html lang="en-US"
    prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">

<head>
     
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="David Calhoun">
    <title>Matching Accented Strings in Javascript - David Calhoun's blog</title>
    
    <style>

    html body {
        font-family: 'Roboto', sans-serif;
    }

</style>


 
<link rel="stylesheet" href="https://www.davidbcalhoun.com/css/main.min.64d0177e93dd5f305b3605f903254ec6082add434df66d683d69d7bce0c5caa8.css">
 <link rel="preconnect" href="https://comments.davidbcalhoun.com">
<link rel="preconnect" href="https://ssl.gstatic.com">
<link rel="preconnect" href="https://cdnjs.cloudflare.com">
<link rel="preconnect" href="https://accounts.google.com">
<link rel="preconnect" href="https://apis.google.com">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preload" href="/commento.css" as="style">



 <meta name="generator" content="Hugo 0.62.0" />
    

    
    
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-5530615-3', 'auto');
        ga('send', 'pageview');
    </script>
    
    

    <style>
         
         
         
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            font-display: swap;
            src: local('Roboto'), local('Roboto-Regular'),
                url('/wp-content/fonts/roboto-v20-latin-regular.woff2') format('woff2'),
                 
                url('/wp-content/fonts/roboto-v20-latin-regular.woff') format('woff');
             
        }
    </style>

    
    <meta name="description" content="Personal blog of photographer and web developer David Calhoun." />
    
    <link rel="canonical" href="https://www.davidbcalhoun.com/2019/matching-accented-strings-in-javascript/">
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="David Calhoun&#39;s blog" />
    <link href="/index.xml" rel="feed" type="application/rss+xml" title="David Calhoun&#39;s blog" />
    <link href="/index.xml" rel="self" type="application/rss+xml" title="David Calhoun&#39;s blog" />
    <meta name="format-detection" content="telephone=no">

    
    <meta itemprop="name" content="Matching Accented Strings in Javascript" />
    <meta itemprop="headline" content="Matching Accented Strings in Javascript" />
    
    
    <meta itemprop="image" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" />
    
    <meta itemprop="author" content="David Calhoun" />
    <link rel="me" href="https://www.themaingate.net/" type="text/html">
    <link rel="me" href="mailto:david.b.calhoun+dc@gmail.com">
    <link rel="me" href="https://www.linkedin.com/in/davidcalhoun/" type="text/html">
    <link rel="me" href="https://github.com/davidcalhoun" type="text/html">
    <link rel="me" href="https://twitter.com/franksvalli" type="text/html">
    <link rel="archives" href="https://example.com/archives/">

    
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.davidbcalhoun.com/2019/matching-accented-strings-in-javascript/" />
    <meta property="og:title" content="Matching Accented Strings in Javascript" />
    
    <meta property="og:image" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" />
    
    
    <meta property="og:image:alt" content="A bug when performing a search for maches with accents (diacritics)." />
    
    
    <meta property="og:site_name" content="David Calhoun's Blog" />
    
    <meta property="og:updated_time" content=2019-10-10T00:00:00Z />
    

    
    
    <meta property="article:published_time" content=2019-10-10T00:00:00Z />
    <meta property="article:modified_time" content=2019-10-10T00:00:00Z />
    
    
    
    <meta property="article:section" content="javascript" />
    
    
    <meta property="article:author" content="https://www.davidbcalhoun.com" />
    
    <meta property="article:image" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" />
    
    
    <meta property="article:tag" content="javascript" />
    
    <meta property="article:tag" content="regexp" />
    
    <meta property="article:tag" content="criterion" />
    

    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Matching Accented Strings in Javascript" />
    <meta name="twitter:url" content="https://www.davidbcalhoun.com/2019/matching-accented-strings-in-javascript/" />
    <meta name="twitter:site" content="@franksvalli" />
    <meta name="twitter:creator" content="@franksvalli" />
    <meta name="twitter:domain" content="davidbcalhoun.com" />
    
    
    <meta name="twitter:image" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" />
    
    
    <meta name="twitter:image:alt" content="A bug when performing a search for maches with accents (diacritics)." />
    


    <link rel="Shortcut Icon" type="image/ico" href="https://www.davidbcalhoun.com/favicon.ico">
</head>



<body>
     
    <nav class="navbar">

        <div class="navbar-header">
            <a class="navbar-brand" href="https://www.davidbcalhoun.com/">David Calhoun&#39;s blog</a>
        </div>

        
        <ul class="navbar-links">
            
            <li class="navbar-icon"><a aria-label="Send an email" title="Send an email" href="mailto:david.b.calhoun&#43;dc@gmail.com"><svg aria-label="email" role="img" width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1664 1504v-768q-32 36-69 66-268 206-426 338-51 43-83 67t-86.5 48.5-102.5 24.5h-2q-48 0-102.5-24.5t-86.5-48.5-83-67q-158-132-426-338-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5zm0-1051v-24.5l-.5-13-3-12.5-5.5-9-9-7.5-14-2.5h-1472q-13 0-22.5 9.5t-9.5 22.5q0 168 147 284 193 152 401 317 6 5 35 29.5t46 37.5 44.5 31.5 50.5 27.5 43 9h2q20 0 43-9t50.5-27.5 44.5-31.5 46-37.5 35-29.5q208-165 401-317 54-43 100.5-115.5t46.5-131.5zm128-37v1088q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-1088q0-66 47-113t113-47h1472q66 0 113 47t47 113z"/></svg></i></a>
            </li>
            
            <li class="navbar-icon"><a aria-label="Home Page" title="Home Page" href="https://www.themaingate.net/"><svg aria-label="home site" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg></i></a>
            </li>
            
            <li class="navbar-icon"><a aria-label="Twitter" title="Twitter" href="https://twitter.com/franksvalli/"><svg aria-label="twitter" role="img" width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></i></a>
            </li>
            
            <li class="navbar-icon"><a aria-label="Github" title="Github" href="https://github.com/davidcalhoun/"><svg aria-label="github" role="img" width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M896 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 .5-76.5t.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 88.5t.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zm-477 1103q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zm31 34q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zm30 45q9-7 0-19-8-13-17-6-9 5 0 18t17 7zm42 42q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zm57 25q3-11-13-16-15-4-19 7t13 15q15 6 19-6zm63 5q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zm58-10q-2-11-18-9-16 3-14 15t18 8 14-14z"/></svg></i></a>
            </li>
            
            <li class="navbar-icon"><a aria-label="LinkedIn" title="LinkedIn" href="https://www.linkedin.com/in/davidcalhoun/"><svg aria-label="linkedin" role="img" width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></i></a>
            </li>
            
        </ul>
        

    </nav>

<main role="main" itemscope itemType="https://schema.org/BlogPosting">
    <meta itemprop="mainEntityOfPage" content="https://www.davidbcalhoun.com/2019/matching-accented-strings-in-javascript/" />
    <meta itemprop="inLanguage" content="en-US" />
    <span itemscope itemprop="author" itemType="https://schema.org/Person">
        <meta itemprop="name" content="David Calhoun" />
        <meta itemprop="url" content="https://www.themaingate.net" />
    </span>
    <span itemscope itemprop="publisher" itemType="https://schema.org/Organization">
        <meta itemprop="name" content="David Calhoun" />
        <meta itemprop="url" content="https://www.themaingate.net" />
        <span itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="https://www.themaingate.net/david-calhoun-logo.png">
            <meta itemprop="width" content="459">
            <meta itemprop="height" content="459">
        </span>
    </span>
    <meta itemprop="image" content="https://www.themaingate.net/david-calhoun-logo.png" />
    
    <meta itemprop="datePublished" content=2019-10-10T00:00:00Z/>
    <meta itemprop="dateModified" content=2019-10-10T00:00:00Z/>
    

    <article class="item">

    
    
    

    
    


    <h1 itemprop="headline" class="meta title">
        <a href="https://www.davidbcalhoun.com/2019/matching-accented-strings-in-javascript/" itemprop="url">Matching Accented Strings in Javascript</a>
    </h1>

    <time class="meta date" datetime="2019-10-10 00:00:00 &#43;0000 UTC">
        
        October 10, 2019
        
    </time>
    <aside class="meta tags">
        <span>Tags: </span>
        
        <a href="https://www.davidbcalhoun.com/tags/javascript"><span class="item-tag">javascript</span></a>
        
        <a href="https://www.davidbcalhoun.com/tags/regexp"><span class="item-tag">regexp</span></a>
        
        <a href="https://www.davidbcalhoun.com/tags/criterion"><span class="item-tag">criterion</span></a>
        
    </aside>

</article>


    <div class="text-justify"><h2 id="the-problem-accented-characters-versus-user-input">The problem: accented characters versus user input</h2>
<p>I've really been enjoying (wait for it, unpaid endorsement) <a href="https://www.criterionchannel.com/">The Criterion Channel</a> since it launched earlier this year.  The app and the website are nascent and therefore have had their share of problems, but to their credit they have been hard at work making things smoother day by day.</p>
<p>But one big annoying thing in general is searchability of films in general.  Recently I found a <a href="https://www.reddit.com/r/criterion/comments/ddg08d/channel_software_engineers_your_input_validation/">reddit post</a> revealing another big search annoyance: bad handling of matching strings with accented titles, particularly when searching for &lsquo;samourai&rsquo; and expecting &lsquo;Le Samouraï&rsquo; to pop up in the results:</p>
<figure itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject" class="center">
    <meta itemprop="width" content="700" />
    <meta itemprop="height" content="496" />
    <meta itemprop="url" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" />
    <a href="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif">
        <img itemprop="contentUrl" src="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-without-diacritic.gif" title="Searching for 'samourai' without a diacritic yields no results :(" />
    </a>
    <figcaption itemprop="caption">Searching for 'samourai' without a diacritic yields no results :(</figcaption>
</figure>
<figure itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject" class="center">
    <meta itemprop="width" content="700" />
    <meta itemprop="height" content="496" />
    <meta itemprop="url" content="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-with-diacritic.gif" />
    <a href="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-with-diacritic.gif">
        <img itemprop="contentUrl" src="https://www.davidbcalhoun.com/wp-content/uploads/2019/criterion-search-with-diacritic.gif" title="Successful exact match only when the user types in an 'i' with a diacritic (ï)" />
    </a>
    <figcaption itemprop="caption">Successful exact match only when the user types in an 'i' with a diacritic (ï).  (note: the original search text also disappears, another bug!)</figcaption>
</figure>
<p>The Criterion Collection is home to many foreign films, so it's natural that many of the titles would have accents, so this is a bit unfortunate for their users.</p>
<h2 id="first-steps-at-a-solution">First steps at a solution</h2>
<p>I used this as an opportunity to learn something new!  I realized that I didn't immediately know how to solve for this either.  A simple regexp was no help:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">// Only works because there&#39;s no accented characters.
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;Le Samourai&#39;</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/samourai/i</span>);
<span style="color:#75715e">// -&gt; [&#39;Samourai&#39;]
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// ...but once we introduce accented characters, our naïve implementation blows up...
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;Le Samouraï&#39;</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/samourai/i</span>);
<span style="color:#75715e">// -&gt; null
</span></code></pre></td></tr></table>
</div>
</div><p>I had to go digging a bit to figure out how to make progress&hellip;</p>
<p>This <a href="https://stackoverflow.com/a/37511463/214017">great answer by Lewis Diamond on Stackoverflow</a> lead the way to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize">String.prototype.normalize()</a>, but before we jump into that, first we need to take care of some prerequisites with a super brief Unicode overview.</p>
<p>Like many other Unicode characters, what appears to be just one simple character <code>'ï'</code> can actually be represented in two different ways which are displayed identically as <code>'ï'</code>:</p>
<ul>
<li><code>'\u00ef'</code> (&lsquo;Latin Small Letter I with Diaeresis&rsquo;)</li>
<li><code>'\u0069\u0308'</code> (&lsquo;Latin Small Letter I&rsquo; plus &lsquo;Combining Diaeresis&rsquo;)</li>
</ul>
<p>Unicode generally calls the first the composed/precomposed form, while the second is decomposed into two symbols (&lsquo;i&rsquo; and the <a href="https://en.wikipedia.org/wiki/Diaeresis_(diacritic)">diacritic</a>).</p>
<h2 id="side-note-with-unicode-things-are-not-always-as-they-appear">Side note: with Unicode, things are not always as they appear&hellip;</h2>
<p>What is somewhat strange is that though the Unicode characters display exactly the same way and are considered <a href="https://en.wikipedia.org/wiki/Unicode_equivalence">Unicode equivalent</a>, in JavaScript they are not equal:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#e6db74">&#39;ï&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u00ef&#39;</span>;        <span style="color:#75715e">// true
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;ï&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>;  <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// You may then think that the following must be true in JavaScript
</span><span style="color:#75715e"></span><span style="color:#75715e">// (e.g. transitive equality), but you&#39;d be wrong!
</span><span style="color:#75715e"></span>
<span style="color:#e6db74">&#39;\u00ef&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>;  <span style="color:#75715e">// false
</span><span style="color:#75715e"></span><span style="color:#75715e">// Note that the line above may display as &#39;ï&#39; === &#39;ï&#39;, but it will
</span><span style="color:#75715e"></span><span style="color:#75715e">// still evaluate to false!
</span></code></pre></td></tr></table>
</div>
</div><h2 id="removing-diacritics">Removing diacritics</h2>
<p>What is most interesting for us here is that we can actually take the decomposed form <code>'\u0069\u0308'</code> and <strong>remove</strong> the diacritic (the two dots) simply by removing the symbol <code>'\u0308'</code> (&lsquo;Combining Diaeresis&rsquo;):</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">// Before: with accent
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;ï&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>;

<span style="color:#75715e">// After: violà!  accent removed
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;i&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u0069&#39;</span>;
</code></pre></td></tr></table>
</div>
</div><p>That's looking a lot closer to what the original user input was, and will make things easier to match.  Sort of like converting two strings using <code>toLowerCase()</code> to check their case-insensitive equivalence.</p>
<p>It turns out that all diacritics have a predictable Unicode range, so we can easily remove any diacritics with a regexp character range:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/[\u0300-\u036f]/g</span>, <span style="color:#e6db74">&#39;&#39;</span>);
<span style="color:#75715e">// -&gt; &#39;i&#39;
</span></code></pre></td></tr></table>
</div>
</div><p>One big catch though - this will only work for decomposed symbols.  What happens if we get a composed symbol?  We'd be stuck, since we can't break it apart into separate character and diacritic symbols&hellip;</p>
<p>&hellip;or <em><strong>can</strong></em> we?</p>
<h2 id="stringprototypenormalize-to-the-rescue"><em><strong><code>String.prototype.normalize()</code> to the rescue!</strong></em></h2>
<p>This handy function can convert Unicode characters between their composed and decomposed forms:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">// Remember, though Unicode equivalent and identical in display, this is false...
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;\u0069\u0308&#39;</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u00ef&#39;</span>;  <span style="color:#75715e">// false
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// BUT we can use String.prototype.normalize() to help out!
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// To composed form (&#39;NFC&#39; means Normalization Form Canonical Composition)
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>.<span style="color:#a6e22e">normalize</span>(<span style="color:#e6db74">&#39;NFC&#39;</span>) <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u00ef&#39;</span>;  <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// To decomposed form (&#39;NFD&#39; means Normalization Form Canonical Decomposition)
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;\u00ef&#39;</span>.<span style="color:#a6e22e">normalize</span>(<span style="color:#e6db74">&#39;NFD&#39;</span>) <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;\u0069\u0308&#39;</span>;  <span style="color:#75715e">// true
</span></code></pre></td></tr></table>
</div>
</div><p>This normalization allows us to easily convert to decomposed form, so our regexp above will correctly remove diacritics.  We can now put together the pieces (pun intended) and make a basic helper function to remove accents (diacritics):</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">removeDiacritics</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">str</span> =&gt; {
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>
    .<span style="color:#a6e22e">normalize</span>(<span style="color:#e6db74">&#39;NFD&#39;</span>)
    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/[\u0300-\u036f]/g</span>, <span style="color:#e6db74">&#39;&#39;</span>);
}

<span style="color:#75715e">// Let&#39;s try it out!
</span><span style="color:#75715e"></span><span style="color:#a6e22e">removeDiacritics</span>(<span style="color:#e6db74">&#39;àbçdëfghïjklmñöpqrśtüvwxÿž&#39;</span>);
<span style="color:#75715e">// -&gt; &#39;abcdefghijklmnopqrstuvwxyz&#39;
</span></code></pre></td></tr></table>
</div>
</div><h2 id="complete-example-code">Complete example code</h2>
<p>Now we can put it all together into a working example that would solve the original problem with user input in the Criterion Channel's website:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">// Strips diacritics from a string
</span><span style="color:#75715e"></span><span style="color:#75715e">// Example: removeDiacritics(&#39;ï&#39;) -&gt; &#39;i&#39;
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">removeDiacritics</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">str</span> =&gt; {
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>
    .<span style="color:#a6e22e">normalize</span>(<span style="color:#e6db74">&#39;NFD&#39;</span>)
    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/[\u0300-\u036f]/g</span>, <span style="color:#e6db74">&#39;&#39;</span>)
}

<span style="color:#75715e">// Determines if a haystack contains a needle.  Case and accent insensitive.
</span><span style="color:#75715e"></span><span style="color:#75715e">// Example: normalizedContains(&#39;Le Samouraï&#39;, &#39;I&#39;) -&gt; true
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">normalizedContains</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">haystack</span>, <span style="color:#a6e22e">needle</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">regExp</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RegExp(<span style="color:#a6e22e">removeDiacritics</span>(<span style="color:#a6e22e">needle</span>), <span style="color:#e6db74">&#39;gi&#39;</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">regExp</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">removeDiacritics</span>(<span style="color:#a6e22e">haystack</span>));
}

<span style="color:#75715e">// Returns all films matching the input string.  Case and accent insensitive.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">findMatchingFilms</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">strToMatch</span>, <span style="color:#a6e22e">films</span>) =&gt; {
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">films</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">filmTitle</span> =&gt; <span style="color:#a6e22e">normalizedContains</span>(<span style="color:#a6e22e">filmTitle</span>, <span style="color:#a6e22e">strToMatch</span>))
}

<span style="color:#75715e">// List of all films available (shortened for this example of course!)
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">allFilms</span> <span style="color:#f92672">=</span> [
  <span style="color:#e6db74">&#39;Le Samouraï&#39;</span>,
  <span style="color:#e6db74">&#39;House&#39;</span>,
  <span style="color:#e6db74">&#39;The Samourai Witches From Gomorrah&#39;</span>,
  <span style="color:#e6db74">&#39;Black Narcissus&#39;</span>,
  <span style="color:#e6db74">&#39;Citizen Kane&#39;</span>,
  <span style="color:#e6db74">&#39;Citizen Samourai&#39;</span>
]

<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">findMatchingFilms</span>(<span style="color:#e6db74">&#39;samourai&#39;</span>, <span style="color:#a6e22e">allFilms</span>));
<span style="color:#75715e">// -&gt; [&#34;Le Samouraï&#34;, &#34;The Samourai Witches From Gomorrah&#34;, &#34;Citizen Samourai&#34;]
</span></code></pre></td></tr></table>
</div>
</div><h2 id="references">References</h2>
<ul>
<li><a href="https://stackoverflow.com/a/37511463/214017">https://stackoverflow.com/a/37511463/214017</a></li>
<li><a href="https://dmitripavlutin.com/what-every-javascript-developer-should-know-about-unicode/">https://dmitripavlutin.com/what-every-javascript-developer-should-know-about-unicode/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize</a></li>
<li><a href="https://en.wikipedia.org/wiki/Precomposed_character">https://en.wikipedia.org/wiki/Precomposed_character</a></li>
</ul>
</div>

    
    

    

</main>

		<section class="comments">
			<h2 class="page-header">Comments</h2>
			<section id="commento"></section>
			<script src="/commento.js"></script>
		</section>

        <footer role="contentinfo">

            <p class="copyright text-muted">©<span itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="David Calhoun"><a href="https://www.themaingate.net/">David Calhoun</a></span> - <a href="https://www.davidbcalhoun.com/privacy/">Privacy</a> - <a href="https://www.davidbcalhoun.com/terms-of-service/">Terms</a></p>

        </footer>
       
    </body>

</html>

